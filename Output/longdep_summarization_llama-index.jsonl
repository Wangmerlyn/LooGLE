{"qa_pairs": "none", "llm_output": ["\nThis paper discusses the distinction and quadratic base change for regular supercuspidal representations of a connected reductive algebraic group over a non-archimedean local field. The distinction property of an irreducible representation can be described in terms of the symmetry of the representation itself or the functorial property of the Langlands parameter associated to the representation. Dipendra Prasad has a conjecture describing the relationship between the distinction property of an irreducible representation with respect to a specific quadratic character and the base change property of its Langlands parameter. This paper attempts to prove Prasad's conjecture for regular supercuspidal representations without constraints on the Galois symmetric pair using a different purely local method. The main ingredients used are Hakim-Murnaghan's description of the Hom space by Mackey theory and Kaletha's parametrization of regular supercuspidal representations using tame regular elliptic pairs. The paper also discusses the Langlands-Vogan bijection for regular supercuspidal representations of the group and the compatibility between the formulation and the original base change map."], "output": ["Distinction and quadratic base change for regular supercuspidal representations\n\n\nChuijia Wang\n\n\n1 Introduction\nLet  be a connected reductive algebraic group over a non-archimedean local field  with residual characteristic . In the study of representation theory of , one important problem is to capture the distinguished representations with respect to a pair , where  is a closed subgroup of  and  is a one dimensional character of . More precisely, an irreducible smooth representation  of  is said to be -distinguished ifThe distinction property of an irreducible representation could be described in two common ways. One is in terms of the symmetry of the representation itself, such as the self dual or conjugate self dual property. The other one is in terms of the functorial property of the Langlands parameter associated to the representation.\nSakellaridis and Venkatesh [SV17] have set up a general framework to understand the relationship between distinguished representations and Langlands functoriality when the corresponding homogeneous space  is a spherical variety. Moreover, Dipendra Prasad [Pra15] has a more precise conjecture describing the relationship between the distinction property of an irreducible representation with respect to a specific quadratic character and the base change property of its Langlands parameter when  is a Galois symmetric space.\nThe main focus of this article is to understand Prasad\u2019s conjecture on the Galois distinction problem. More precisely, let  be a quadratic extension and  be the non-trivial element in . We are interested in the distinction problem for the pair , where  is regarded as a closed subgroup of  and  is the specific quadratic character of  associated to the quadratic extension  defined in [Pra15]. Let  denote the set of equivalence classes of irreducible representations of  and  denote the set of  conjugacy classes of Langlands parameters of . The local Langlands correspondence states that there exists a finite-to-one surjective map from  to , which is denoted by . Prasad [Pra15] predicts that the Langlands parameters of -distinguished representations are exactly those which are base change from Langlands parameters of , where  is a quasi-split -form of  such that . One can refer to Section\u00a05 for a more detailed description of these notions. In other words, we have the following:Moreover, he also conjectures that the following identity holds for an irreducible discrete series representation  of  in a generic -packet:where the sum of RHS runs over all the Langlands parameters  such that ,  denotes the irreducible representation of the component group  associated to , and  is the multiplicity of the trivial representation in the restriction of . Notice that 1.1 follows from 1.2, when both sides of 1.2 are non-zero.\nThis conjecture unifies a number of conjectures which aim to capture the distinction property of representations for Galois symmetric pairs and considerable progress has been made in attacking Prasad\u2019s conjecture for specific Galois pairs. For the pair , this conjecture generalizes a conjecture of Jacquet, Rallis and Flicker [Fli91], which states that the -distinguished representations of  are precisely those arising as base change from , and the conjecture is proved by Kable [Kab04] for discrete series representations. For the pair , this conjecture generalizes a conjecture of Jacquet [Jac05][Jac10] and is proved by Feigon, Lapid and Offen [FLO12]. Anandavardhanan and Prasad prove the conjecture for  in [AP03][AP16], where they give the first example of a non-supercuspidal Gelfand pair. More precisely, they find that the dimension of the space of invariant linear forms is strictly larger than one for some supercuspidal reprensentations. Hengfei Lu [Lu19][Lu20] proves this conjecture for certain classical groups of small rank and their similitude groups using the machinery of local theta correspondence. All of these work depends on concrete analysis of the terms appearing on both sides of Prasad\u2019s identity, and developing a general method which could work for all Galois symmetric pairs would be interesting. Recently, Raphael Plessis [Rap18] develops a relative trace formula approach to attack Prasad\u2019s conjecture for general groups. His method turns out to be powerful, and has already been used to prove Prasad\u2019s conjecture for Steinberg representations, which recovers early results proved by Broussous and Court\u00e9s [BC14] [Cou15] using the geometry of Bruhat-Tits building, and by Matringe [Mat17] through careful analysis of double cosets appearing in Mackey theory.\nIn this article, we try to give some evidence on the possibility of proving this conjecture for regular supercuspidal representations without constraints on the Galois symmetric pair using a different purely local method. Supercuspidal representations are fundamental objects in the study of representation theory of -adic groups. They serve as building blocks of all irreducible smooth representations in the sense that every irreducible representation can be realized as a subrepresentation of a parabolic induction from a supercuspidal representation of a Levi subgroup. One of the reasons why we work on regular supercuspidal representations is that they are parametrized by simple data and their Langlands parameters have good functorial properties. These representations are special cases of tamely ramified supercuspidal representations satisfying certain regular conditions. Explicit constructions of tame supercuspidal representations date back to the work of Howe [How77]. Following his pioneering work, tremendous progress has been made in the explicit construction of tame supercuspidal representations for general reductive groups. Jiu-Kang Yu [Yu01] first develops a general construction of tamely ramified supercuspidal representations using generic cuspidal -data , which generalizes the earlier work of Adler [Adl98]. Ju-Lee Kim [Kim07] later shows that the representations constructed by Yu exhaust all the irreducible supercuspidal representations when the charateristic of the residue is large enough. Recently, the exhaustion theorem is improved by Jessica Fintzen [Fin18] under a weaker constraint on . Based on Yu\u2019s work, Tasho Kaletha [Kal19] classifies regular supercuspidal representations using simpler data  and established the local Langlands correspondence for regular supercuspidal representations. As pointed out by Kaletha, one crucial property of a regular supercuspidal representation is that its Langlands parameter factors through the -group of the elliptic torus  which defines the representation:This property enables us to describe the base change of  in terms of the base change of  because of the following commutative diagram of functorial maps:\nTo state and prove Prasad\u2019s conjecture for regular supercuspidal representations, we need the Langlands-Vogan bijection for regular supercuspidal representations of . For these representations, the full Langlands-Vogan bijection, that is, the map  and the bijection between the set of characters of the component group and the set of rational equivalence classes of rational embeddings of tori, are constructed in a series of papers [Kal19] [FKS21]. In fact, they also deal with more general supercuspidal representations, which are known as non-singular representations. Their work enables us to use the parametrization results of regular supercuspidal representations unconditionally in the study of distinction problem.\nThe main ingredients to prove the conjecture are Hakim-Murnaghan\u2019s description of the Hom space by Mackey theory [HM08] and Kaletha\u2019s parametrization of regular supercuspidal representations using tame regular elliptic pairs [Kal19]. We will use these ingredients in three steps. The first step is to describe the base change map in terms of regular supercuspidal -packet data defined by Kaletha, and check the compatibility between our formulation and the original base change map defined by restriction of the Langlands parameter to the Weil group of the quadratic extension field. Then the right hand side of the conjectural formula 1.2 can be expressed as an identity involving a set of elliptic maximal tori over  and a set of characters of the elliptic tori satisfying certain conditions. The second step is to provide a reinterpretation of Hakim-Murnaghan\u2019s formula on the dimension of the Hom space using the same data that appears on the parameter side of the formula. The final step is to give a comparison between both sides, and reduce the proof to an identity comparing various characters of the elliptic maximal torus , which naturally appear in the distinction problem, the base change problem, and the construction of local Langlands correspondence. A priori, it seems that there is no obvious relation between these characters, whose constructions are of different nature. However, we can prove this conjectural identity for several examples, which gives a new purely local proof of Prasad\u2019s conjecture for regular supercuspidal representations of these groups. We also prove Prasad\u2019s conjecture for regular supercuspidal representations of  when  is unramified, and  is a general quasi-split reductive group.\nPrasad\u2019s conjecture 5.17 holds for regular supercuspidal representations when  is unramified.\nPrasad\u2019s conjecture 5.17 holds for regular supercuspidal representations of ,, ( odd) and  ( odd) for arbitrary quadratic extension .\nThis article is organized as follows. In Section\u00a03 and Section\u00a04, we briefly summarize Kaletha\u2019s work on the construction of -parameters and -packets for regular supercuspidal representations, and study the base change map of Langlands parameters (Lemma\u00a04.1 Proposition\u00a04.2) in terms of Kaletha\u2019s supercuspidal -packet data. After that, we give a brief introduction to Prasad\u2019s conjecture in Section\u00a05, where we also obtain a new factorization formula (Theorem\u00a05.15) for the restriction of Prasad\u2019s quadratic character to an elliptic maximal torus. Then we review Hakim and Murnaghan\u2019s work on the computation of the dimension of the space of invariant linear forms and give a new interpretation of their formula (Equation\u00a06.5) in Section\u00a06. After all these preparation, the reduction to the case of tori (Proposition\u00a07.8 Proposition\u00a07.4) and the comparison of the two sides (Proposition\u00a07.2 Lemma\u00a07.10) are established in Section\u00a07 except for 7.9. In Section\u00a08, we present a detailed study of these quadratic characters and prove Proposition\u00a08.1 and Proposition\u00a08.2, which finishes the proof of Theorem\u00a08.15 and Theorem\u00a08.16.\nAcknowledgement.\nThis article consists of my Ph.D thesis at National University of Singapore. I want to express my sincere thanks to my supervisor Wee Teck Gan for his patient guidance, constant encouragement and valuable discussions over the years. His insight and suggestions play an important role in the whole project. I would like to thank Dipendra Prasad for proposing his conjecture, as well as continuous communications and encouragement during the period of preparing this article. I am also grateful to Tasho Kaletha, Jeffrey Hakim, Fiona Murnaghan, Jiu-Kang Yu, Laure Blasco, Jessica Fintzen, Wen-Wei Li, Chong Zhang and David Schwein for kindly answering my questions. Thanks are also due to Tasho Kaletha, Jeffrey Hakim, Hung Yean Loke, Hengfei Lu, Jiandi Zou for providing useful comments and feedbacks on an early draft. This work was partially supported by a Singapore government MOE Tier 1 grant R-146-000-320-114 and Israel Science Foundation grant 737/20.\n2 Notations and conventions\n2.1 Notation.\nLet  be a non-achimedean local field with residual characteristic . Fix a valuation  on , let ,  and  denote the ring of integers, a uniformizer and the residual field of . Let  denote the cardinality of . Let  be an algebraic closure of  and  be the separable closure of  in .\nFor any finite Galois extension , let  be the finite Galois group. Let \nbe the absolute Galois group with the profinite topology. Let  be the relative Weil group of , that is, an extensionwhich corresponds to the fundamental class in . Let  be the Weil group with locally profinite topology. Let  be the inertia group, and  be the wild inertia group. The natural map from  to  fits into the commutative diagram:Let  denote the Weil-Deligne group. Let  be the maximal unramified extension of  and  be the lift of the Frobenius automorphism of , which is a topological generator of . For any reasonable object (abelian group, non-abelian group, algebraic variety) equipped with a  or  action which is compatible with the structure of , let  denote the -th Galois cohomology of  and  denote the -th Weil cohomology of . If  is the complex points of an algebraic group over , we use  and  to stand for continuous cohomology, by which we mean the cochains are continuous with respect to the natural complex analytic topology of .\nWhenever there is a group homomorphism , we use the notation  instead of  for simplicity, which is a group only when  is normal in . For any one dimensional character  such that , we sometimes use the notation  for simplicity, when there is no confusion.\nFor a reductive group  defined over , let  denote the derived subgroup of , which is semisimple, and  and  denote the simply connected cover and adjoint quotient of . For any maximal torus  defined over  with splitting field , let  denote the set of absolute roots associated to the adjoint action of . When there is no confusion about the maximal torus, we simply write  for convenience. For any root , let  and  be the subfield of  corresponding to the subgroup  and  of .  is an extension of  of degree at most two. If , then  is called asymmetric, otherwise it is called symmetric. Let  and  denote the set of asymmetric and symmetric roots in . Let  be the absolute root datum of . Let  be the Langlands dual group of , which is a complex algebraic group determined by the root datum . For ,  denotes the corresponding element in . Also, for ,  denotes the corresponding element in . We also use the usual notation  for the algebraic fundamental group of  and  for the component group of , both of which are finite when  is semisimple.\nFrom now on till the end, we will always assume that  splits over a tamely ramified extension , and  is a maximal torus of  defined over  which splits over . Let  denote the enlarged Bruhat-Tits building of  over . Set  with a natural partial order: for any ,  if ; ,  if ; and ,  for any . For any  and , let  denote the Moy-Prasad subgroup generated by  and  for any  defined in [MP94], and  be , with corresponding filtration lattices of Lie algebra  and . Let  denote , and  denote . For , we also use the notation  for the Moy-Prasad quotient . For a sequence of twisted Levi subgroups , a sequence  in  and , we use the following notation for simplicity:\nFor an irreducible admissible representation  of , let  be the depth of , which is defined by\nWe will also adopt the notations from [Kal19]. For any  and , let  denote the jumps of , that is,Let  and  denote the following subsets of roots\nFor any quadratic extension , we use the notation  for the set of norm  elements inside . When there is no confusion about the subfield , we simply write .\nWhen  is quasi-split over  with a fixed Borel subgroup  such that  is a maximal torus of  and  is the unipotent radical of , we use the notation  for the pinning of  determined by the pair . By a Whittaker datum , we mean a  conjugacy class of pairs , where  is a generic character of . Let  be a non-trivial additive character. Notice that each choice of  gives a homomorphism , and composing with the addition map  yields a homomorphism . Every generic character  arises as a composition of  and  for some choice of pinning , and we also call  the Whittaker datum determined by the pinning . A representation  of  is said to be generic if it is  distinguished for some Whittaker datum .\n2.2 Assumption.\nSince our work is based on the fundamental work of Kaletha [Kal19], we also need to propose certain assumptions on the ground field as in [Kal19]. We list these assumptions for convenience of the readers. We assume the residual characteristic ,  is not a bad prime for ,  and .\n3 Local Langlands correspondence for regular supercuspidal representations\n3.1 Langlands-Vogan bijection.\nWe first recall the conjectural local Langlands correspondence and Vogan\u2019s refinement. Let  be a quasi-split reductive group defined over , and  be the Weil form of the -group of .\nA Langlands parameter  of  is a homomorphism  such that: is a morphism of algebraic groups over . is continuous on  and  is semisimple in . is the natural projection.The homomorphism  satisfying the above conditions is usually called an admissible homomorphism.\nBy the third condition, for any , we can write , such that  lies in . Notice that  is a homomorphism if and only ifwhich means that one can regard  as an element in .\nLet  denote the set of equivalence classes of irreducible admissible representations of  and  denote the set of  conjugacy classes of Langlands parameters of . The local Langlands correspondence for quasi-split groups predicts that there exists a surjective, finite to one map:such that there exists a bijection between  and  for any , where  is the fiber of  and  is . The set  is called the -packet associated to . This bijection is not canonical and depends on certain normalization of Whittaker datum, under which the trivial representation of the component group corresponds to a generic representation. It is expected that LLC has nice properties, such as preserving local constants on both sides, being compatible with character twists on both sides, etc. We will list some of these properties in Section\u00a03.5.\nLater, Vogan [Vog93] notices that one should consider the representation theory of pure inner twist of  simultaneously in the local Langlands correspondence and he predicts that there should exist a bijection between  and  for any , such that the following diagram commutes:where the bottom arrow is given by the Kottwitz isomorphism. Fixing a Whittaker datum of the quasi-split form , one can associate a pair  to any irreducible representation  of , where  is the usual Langlands parameter and  is an irreducible representation of . The pair  is usually called the Langlands-Vogan parameter (enhanced Langlands parameter) of .\nIt is expected that one can read the information of an irreducible representation from its Langlands parameter. We have the following definitions of various Langlands parameters.\nLet  be a Langlands parameter of . It is calledelliptic (discrete), if  is not contained in any proper Levi subgroup  of . (or equivalently  is finite modulo .)bounded, if the closure of  in  is compact.unramified, if  is trivial.spherically unramified, if  is trivial.tamely ramified, if  is trivial.torally wild, if  is contained in a torus of .\nThese Langlands parameters are supposed to parameterize essentially discrete series, tempered, unipotent (unipotent reduction in the sense of Lusztig), unramified (spherical), depth zero and torally wild (essentially tame in the sense of Bushnell and Henniart for ) representations of .\nThe conjectural refined local Langlands correspondence has been verified for a large number of cases: for all representations of groups of certain type [HT01][Hen00][Sch13][Art13][Mok15][GT11] etc and for particular representations of general reductive groups [DR09][RY14][Kal15][Kal19][Sol 18] etc. One can refer to [Kal16a] for a more detailed description of the status of the conjecture.\nAs conjectured by Gross and Reeder [GR10, Conjecture 7.1 (4)], for a discrete Langlands parameter, the condition  should be equivalent to the condition that all the representations in  are supercuspidal representations. For these representations, the Langlands parameters are simply homomorphisms from  to .\nA regular supercuspidal parameter is a discrete Langlands parameter  such that: is contained in a torus of . is a torus.Let , , if  projects to a nontrival element in , then .\nLet  be a quadratic extension, and  be a regular supercuspidal Langlands parameter of . If  is a Langlands parameter of  such that  is  conjugate to , then  is also a regular supercuspidal parameter of . This is simply due to the fact that  implies  is a tamely ramified extension, so that one has  and .\n3.2 -embedding and -data.\nA crucial property of regular supercuspidal parameters is that they factor though the -group of certain elliptic maximal torus of , which could be regarded as a special example of functoriality discussed in Section\u00a03.5. Let  be an arbitrary maximal tori of a quasi-split reductive group  defined over a local field  of characteristic zero. Langlands and Shelstad [LS87] first realized that one could always extend a -stable  conjugacy class of embedding of dual groups  to an embedding of -groups (Weil form)  with the help of some auxiliary data. We give a brief review about their constructions of -embeddings using -data. A more detailed description could be found in [LS87] and [Tam16].\nLet  be a quasi-split reductive group over , and  be a maximal torus defined over , and we assume  is contained in a Borel subgroup  since  is split. We may choose a -invariant pinning  of  such that  and  maps the simple roots determined by  to those determined by . Notice that the map  is not necessarily -equivariant, we use subscripts  and  to denote the action on  and  for any .\nAn admissible -embedding  is a group homomorphism satisfying:for some .\nFor  to be a homomorphism, one must have:for any . From the first equation, one can see that . From the second equation, one can find that  is a Langlands parameter of .\nBy choosing a base point of an embeddingone can obtain the following fact.\nThe set of  equivalent classes of L-embeddings\n is a torsor under . The explicit bijection with respect to a base point  is given by:Conversely, for any given  and , one can associate an equivalence class of embeddings:\nFor  with elliptic maximal torus  such that  is a degree  extension, one can choose the canonical pinning of  such that  is the diagonal torus. One can choose a  such that . There is a canonical base point  in  such that:withfor any , and  is given by a permutation matrix in  with entries being  and  determined the the above relation. If we fix a character  and  which corresponds to an equivalence class of -embedding in Equation\u00a03.2 with respect to the above base point , the composition gives the Langlands parameter of :\nThe remaining difficulty is to construct a base point of an -embedding in general, which is achieved by Langlands and Shelstad [LS87] using -data.\nA set of -data for  is a collection of elements  satisfying:for any \nA set of -data for  is a collection of elements  satisfying:for any  and\n is the quadratic character attached to  for any symmetric root .\nLet  denote the Weyl group , one can define a section ofin the following way.\nLet  be a simple root of  with root vector . Let  be the corresponding  triple. Let  denote the simple reflection associated to , we setand set  for  with . This section gives a map:where  is the section of  in  and the action of  is given by the difference of the  action on  and  action on , that is\nNotice that the map  is not necessarily a homomorphism of groups. Hence to get a base point, Langlands and Shelsted [LS87] construct a 2 cocyle\nOne needs to find a splitting  of , that is, the map  should satisfy:Such splittings are constructed by a family of -data. We recall the explicit construction of the cochain . (In fact, the explicit realization of  involves certain choices of coset representatives). Fixing a set of representatives  of the left coset , we can define a family of functions  by the following equations:for suitable .\nOne can also define  similarly by fixing the coset representatives  of . More explicitly, for , , and for , .\nWe can define a cochain  by:\nLanglands and Shelstad prove that such  is a splitting of . A priori, the explicit construction of  depends on a choice of certain coset representatives, which has a more elegant interpretation via the notion of gauge introduced in [LS87].\nA gauge is a function  such that  for any .\nA set of coset representatives  of  canonically determines a gauge by . For two different gauges  and , one can associate a cochain  as in [LS87, Lemma 2.4]. The map  and  are related by .\nGiven a cochain  associated to a set of -data  and a fixed gauge , we can extend the embedding  to  by defining:\nThe above map in Equation\u00a03.8 is a group homomorphism.\nThis is essentially contained in [LS87]. We write down the explicit computation for completeness. To check that the map defines a homomorphism, one needs to check the following identity:Notice that by Equation\u00a03.1, we haveWe can also compute  explicitly by:Hence we only need to provewhich is exactly given by Equation\u00a03.6.\n\u220e\nIn fact, the choice of -data is not unique. The difference of -data provides a character of  in the following way.\nA set of -data for  is a collection of elements  satisfying:for any  and\n for any symmetric root  .\nLet  and  be two sets of -data, it is clear from definition that  is a set of -data. Following [LS87] and [Kal19], one can construct a character\nwhere  denotes the isomorphism . By the notation in Equation\u00a03.3, the -embeddings associated to  and  are related by:Among the set of -data, the following ones are crucially used in computing the characters of supercuspidal representations.\nA set of -data:  is called minimally ramified if, if  is asymmetric, is unramified, if  is symmetric unramified, is tamely ramified, if  is symmetric ramified.\nKaletha also introduced the following notion of mod--data, which can be better used in conjunction with tamely ramified -data.\nA set of mod--data for  is a collection of elements  satisfying:for any \nFor regular supercuspidal representations associated to a tame elliptic pair, Kaletha [Kal19] describes a canonical choice of minimally ramified -data associated to the mod--data determined by the character .\n, if  is asymmetric. is the quadratic character associated to the unique unramified quadratic extension of  by local class field theory, if  is symmetric unramified. is the tamely ramified character determined by the following equation, if  is symmetric ramified.\nFor any  and a Howe factorization  in Definition\u00a06.3,where  is the -constant defined by Langlands. More precisely, it has the following expression in terms of Deligne\u2019s local root numbers:where  denotes the additive character  and  similarly.\nNotice that the construction of Equation\u00a03.8 depends heavily on the choice of the -data, which is not unique. For the case of , Tam [Tam16] also constructed certain -data in order to understand the rectifiers defined by Bushnell and Henniart [BH10]. The comparison of Tam\u2019s -data and Kaletha\u2019s canonical minimally ramified -data is carefully studied for regular supercuspidal representations of  in [OK21], which also leads to a comparison of the local Langlands correspondences for these representations established by [HT01][Hen00] and [Kal19]. Throughout this article, we work with Kaletha\u2019s canonical minimally ramified -data.\nRecently, Kaletha [Kal19a] gives a new interpretation of the work of Langlands and Shelstad by introducing certain double cover of the elliptic torus, where the base point of the -embedding associated to the double cover corresponds to a genuine character of the double cover.\n3.3 Kaletha\u2019s parametrization of regular supercuspidal representations.\nBased on the earlier work of Langlands and Shelstad [LS87], Kaletha [Kal19] uses another type of data to describe these regular supercuspidal Langlands parameters, which he calls regular supercuspidal -packet data. He identifies the set of equivalence classes of regular supercuspidal parameters with the set of equivalence classes of regular supercuspidal -packet data, which forms a category. We give a brief review of his construction.\nLet  be a maximal torus and  be a character. The pair  is called tame elliptic regular if is elliptic and splits over a tamely ramified extension .The action of  on the root systempreserves a positive set of roots.the character  has a trivial stabilizer for the action of , where  is a reductive group with maximal torus  and root system .\n[Kal19](Category of regular supercuspidal -packet data.)An object in the category consists of tuples\n, where is an elliptic torus defined over  such that  and  splits over a tamely ramified extension of . is an embedding of complex reductive groups whose  conjugacy class is -stable. is a minimally ramified -data for . is a character, such that  is a tame elliptic regular pair in the sense of Definition\u00a03.11.A morphism between  and  is a triple , where is an isomorphism of -tori inducing an isomorphism of complex torus ., such that . is a set of zeta data, that is, a family of characters , such that , and .\nBy Kaletha [Kal19, 5.1], a -stable  conjugacy class  of embeddings  defined over  determines a -stable  conjugacy class  of embeddings  defined over , and vice versa. Here, the structure of  to be a maximal torus of  is given by , which is determined by , and is not necessarily defined over . Elements in  are usually called admissible embeddings, and the subset of  fixed points in  corresponds to the subset of admissible embeddings defined over , which is non empty due to [Kot82, Corollary 2.2]. As remarked by Kaletha, if we choose a  invariant pinning  of , one can always choose  such that  is an isomorphism over , and pull back  via  to get a  invariant subset . Here the notion of tame regular elliptic pair makes sense if one uses the embedding  defined over  determined by . The notion of symmetric roots or asymmetric roots also makes sense with the help of .\nThere is a natural 1-1 correspondence between the -conjugacy classes of regular supercuspidal parameters and the isomorphism classes of regular supercuspidal -packet data.\nFor a given -packet datum  (equivalently a given regular supercuspidal Langlands parameter ), Kaletha also introduces another category to parameterize supercuspidal representations in the -packet , which he calls the category of regular supercuspidal data. The object in the category is formulated in terms of Kaletha\u2019s rigid inner twist of a quasi-split reductive group. Since Prasad\u2019s original conjecture is formulated in terms of pure inner twist, we only use the pure inner twist version of Kaletha\u2019s fomulation. For relationship between rigid inner form and pure inner form, one can refer to Kaletha\u2019s paper [Kal16].\n[Kal19](Category of regular supercuspidal data.)An object in the category consists of tuples\n, where is a regular supercuspidal -packet datum. is a pure inner twist of , that is  is an isomorphism over  and  is an admissible embedding defined over .A morphism between  and  is a tuple , where is an isomorphism of regular supercuspidal -packet datum. is an isomorphism of pure inner twist of , such that .\nNotice that, one has a natural forgetful functor from the category of regular supercuspidal data to the category of regular supercuspidal -packet data. In this way, the -packet  as a set is in bijection with a torsor under . In fact, one also wants to understand the construction of each member of a given regular supercuspidal -packet data. Kaletha [Kal19] constructs a generic cuspidal -datum from a tame elliptic regular pair, which produces a regular supercuspidal representation by Yu\u2019s construction [Yu01]. We will describe this explicit construction later in Section\u00a06.1.\nFrom a regular supercuspidal datum , one can construct a tame elliptic pair , where  is known as certain rectifying character arising in the earlier work of Debacker-Spice [DS18] and Kaletha [Kal15]. Then, one can run the process described in Section\u00a06.1 to get a regular supercuspidal representation  of  from this tame elliptic pair.\nMore precisely, the character  has the following explicit expression.\nwhere  and  denote the unique non-trivial quadratic character of the cyclic group  and , and  denotes the toral invariants defined in [Kal15].\nMore detailed descriptions of these characters will be given in Section\u00a08.2.1.\n3.4 Comparison of the -packet.\nNow we have two ways to parameterize the set  for a regular supercuspidal Langlands parameter . One is conjecturally given by , while the other one is given by a torsor under . Notice that the first parametrization depends on certain normalization of Whittaker datum, while the second parametrization depends on a base point of the set of equivalence classes of rational embeddings. According to the strong tempered -packet conjecture, there exists a unique  generic representation in a given tempered -packet for a fixed Whittaker datum . Hence, one may expect that a fixed Whittaker datum canonically and uniquely determines a base point inside the set of equivalence classes of -embeddings of abstract tori.\nNotice that for a toral regular supercuspidal representation  with regular supercuspidal -packet data , the following lemma due to Kaletha implies that there exists a canonical choice of rational embedding as a base point in a given -packet for any chosen Whittaker datum.\nFix a Whittaker datum  for  associated to a fixed pinning  defined over  and an additive character . Let  be a toral -packet datum of generic depth . There exists a unique (up to  conjugacy) admissible rational embedding , such that the representation corresponding to  is  generic.\nIn a recent preprint of [FKS21, Page 25], Lemma\u00a03.9 is generalized to arbitrary regular supercuspidal representations. After fixing the base point, then these two parameterizations coincide as a consequence of Kottwitz isomorphism for tori and the following lemma due to Kaletha.\nThe embedding  induces an isomorphism .\nUnder this isomorphism,  is isomorphic to  by the Kottwitz isormophism for tori. Fix a base point of -embedding , then  could be regarded as an element in  by , which we still denote by  for simplicity.\n3.5 Cohomological aspects of local Langlands correspondence.\nIn the study of functorial properties of Langlands parameters, it is often convenient for us to ignore the Frobenius semisimplicity condition and regard  as a subset ofNotice that there is a natural bijection:which provides a parametrization of the (enlarged) space of equivalence classes of Langlands parameters by  as a pointed set. In this way, many functorial maps between Langlands parameters could be described in terms of natural maps between non-abelian Galois cohomology.\n3.5.1 Functoriality.\nThe principle of Langlands functoriality provides evidence that there may exist a deep relation between representations of different reductive groups. In a simple word, the Langlands functoriality predicts the existence of certain transfer of representations whenever there exists a homomorphism between their -groups. More precisely, we assume that  is also a reductive group defined over , and there exists an algebraic homomorphism :For any Langlands parameter  of , we can get a Langlands parameter  of  by composing  with :\nwhich implies that  defines a map from the set of Langlands parameters of  to those of .\nNotice that  descents to a map from  to , hence defines a transfer from  to . In fact, if we ignore the Frobenious semisimplicity condition,  also defines a map:If there exists a -equivariant mapbetween complex dual groups, then one can easily extend this homomorphism to a homomorphism of -groups simply by:\nIn this case,  should coincide with  induced by the  equivariant map , which provides a Galois cohomological interpretation of the funtoriality. However, the map  is not -equivariant in general and the -homomorphism  is usually not an extension of a -equivariant . Nonetheless,  may still enjoy some nice cohomological properties as , which will be seen soon.\n3.5.2 Twisted by characters and taking central characters.\nNotice that the set of continuous characters of  inherits a natural structure of abelian group with group structure given by pointwise multiplication. In this case, we also have a parametrization of this set in terms of abelian Galois cohomology.\nThere is a natural map:which is a bijection when  is quasi-split.\nIn fact, there is a convenient description of the above map using hypercohomology of crossed modules. This has been described in detail in [Bor98], [Kal15] and [Lab08]. Let  be a crossed module. More precisely,  is a group homomorphism and  is endowed with an action of  such thatfor any . Notice that the second equation implies that  is abelian. Let  be a group acting on the crossed module such that the action is compatible with the crossed module structure, that isthen we have the following cohomology theory for crossed modules:where the hypercocycles  and hypercoboundaries  are defined by:Remark that we also adopt the notation in [Kal15] such that the degree in our definition is shifted by  from the usual degree in the cohomology theory of crossed modules. The reason is explained in [Kal15] for the compatibility between the cohomology of crossed module and hypercohomology of a complex concentrated in degree  and , when we take the crossed module to be a complex of tori.\nUsing the above notation, we have the following isomorphisms.\nThere are canonical isomorphisms:and\nThe map  and the map (on the parameter side) of taking the central character of an irreducible representation correspond to the following natural maps between Galois cohomology.\nThe map  is given by:The map of taking the central character is given by:\nFor , the map of taking the central character has a simple description. Notice that we have a short exact sequence of -modules:which means that we have a quasi isomorphism of crossed modules:and the following commutative diagram:Hence the map of taking the central charactercoincides with the map of taking determinant on the parameter side\nNotice that the set of continuous characters of  acts naturally on the set of equivalence classes of irreducible representations of  by character twists, that is, one has a natural actionwhich corresponds to the following action on the parameter side:such that  is given by .\nFixing an elliptic maximal torus , Kaletha\u2019s construction of regular supercuspidal representations in Section\u00a06.1 and his construction of local Langlands for regular supercuspidal representations could be regarded as a map\nFor any character  with  being regular elliptic, the following well known isomorphism between supercuspidal representations yields the compatibility of character twists and the construction of regular supercuspidal representationswhich corresponds to the commutativity of the diagram on the parameter side:\n4 Base change of regular supercuspidal -packet data\nBase change is one of the examples of Langlands functoriality. From the point of view of trace formula and harmonic analysis, the theory of base change could be understood as a special example of the theory of twisted endoscopy, which has been detailed studied in [KS99]. We will not go deep into the theory of twisted endoscopy, instead we only focus on the local counterpart of quadratic base change.\n4.1 Base change of Langlands parameters.\nLet  be a quadratic extension. For a Langlands parameter  of , a base change  of  is nothing but the composite of  with the functorial map:where the  action on  is given by:\nIn other words, BC induces natural maps:There is an alternative way to describe the base change map. Since  is defined over ,  is naturally a -group. Consider the following -group:with the group law induced from the one on . To be more precise, for any , one defines .\nThere is a natural  action on  given by right multiplication, which preserves the group law:Choosing any element , we could construct a -equivariant isomorphism:For any , we have:which implies that the isomorphism does not depend on the choice of , hence is canonical. Moreover, we have the following commutative diagram:where the -equivariant map  is defined by:By Shapiro\u2019s lemma for non-abelian Galois cohomology, we have:Hence  coincides with the restriction map, which means that  could be identified with the restriction .\nMany aspects in the theory of base change have Galois cohomological interpretations. It turns out that the following remark in Prasad\u2019s paper [Pra15], which describes the fiber of base change map, is quite useful in our work.\nPicking up a base point  associated to an irreducible representation  of , we can twist the action of the Weil group on  by , which means we can define a new  action on  by:such that  corresponds to the distinguished point in . One advantage of doing this is that we have an identification:If we assume there exists an extension , such that , then under this twisted action, the set of possible extensions of  to a parameter of  can be described by the inflation-restriction sequence:where  denotes the corresponding non-abelian Galois cohomology associated to the twisted  action.\nThe obstruction of extending the parameter of  to a parameter of  could also be read from this inflation restriction sequence. For example, the inflation restriction map implies the image of  lies in . Hence a necessary condition for  to be extendable to parameters of  is that it is -invariant.(The Galois action is given by conjugation of an element in ). In fact, this is not the only obstruction. For general Langlands parameters, the inflation restriction sequence terminates due to the lack of  for non abelian -groups. However, for regular supercuspidal representations,  is still meaningful due to the special isomorphism in Lemma\u00a03.10.\n4.2 Base change for regular supercuspidal -packet data.\nNow we use tuples  as Langlands parameters for regular supercuspidal representations of . We would like to describe the quadratic base change in terms of regular supercuspidal -packet data. For simplicity, we first focus on those regular supercuspidal -packet data whose base change to  remain regular supercuspidal.\nA quadratic base change of a supercuspidal -packet datum of  associated toto  is given by a supercuspidal -packet datum of , which is equivalent to:where  is a -data of , such that .\nThe above definition of base change map only depends on the equivalence class of the supercuspidal -packet datum. Let  denote the subcategory of the category of regular supercuspidal -packet data of  over  consisting of the objects whose base change (in the usual sense) to  remain regular supercuspidal, then  can be regarded as a functor from  to the category of regular supercuspidal -packet data of  over .\nIt is enough to treat the case when the -isomorphism of  is the identity map. General cases could be reduced to this case by composing the isomorphism over . Recall  and  are equivalent, if and only if:where  is a character  constructed from the zeta datum  (product of characters depending on whether the root is symmetric or asymmetric) determined by the ratio of  and .\nComposing both sides with , we need to prove the following identity in order to check the definition of base change is well-defined:We only need to check this identity for a fixed  orbit of , which will imply the whole identity by taking the product of components of these orbits.If the  orbit of  remains a single  orbit, then we have the following diagramorNotice that we have a correspondence of orbits when  is symmetric, andwhen  is asymmetric.Hence the identity which we want to prove in this case ( component of Equation\u00a04.3) is given byIn this case, we have . We also have the following commutative diagram:In this case, the symmetric property of  is the same over  and . Based on the commutativity of the above diagram and the fact , one has the following identity:Composing both sides with , we havewhere  and  are identity maps when  is asymmetric over  and , and are isomorphisms , , when  is symmetric over  and .If the  orbit of  breaks into two  orbits, that is  for , with projection , then we have the following cases:The symmetry of  is different over  and .The only possibility is that  is symmetric over , but asymmetric over . In this case, one can choose  to satisfy . In this case, we have  and the following diagramNotice that we have a correspondence of orbits Hence the identity which we want to prove in this case ( component of Equation\u00a04.3) is given byIn this case, we have the following commutative diagramthat is,Composing both sides with , we haveNotice that in this case we havewhich implies thatThe symmetry of  is the same over  and .In this case, we have  and the following diagram:orNotice that we have a correspondence of orbits when  is symmetric andwhen  is asymmetric.Hence the identity which we want to prove in this case ( component of Equation\u00a04.3) is given byIn this case, we have the following commutative diagramthat is, we haveComposing both sides with , we haveNotice that in this case, we havewhich implies that\u220e\nA base change of supercuspidal -packet datum sending  to  coincides with the usual base change of the Langlands parameter sending  to .\nBefore we give a proof of this proposition, we have the following remarks on the base change maps of regular supercuspidal parameters.\nOne bad news is that  may fail to be minimally ramified. However, one can still find a representative in the equivalence class with minimally ramified -data over  by adjusting the character as in Definition\u00a03.12. More precisely, one can find a 4-tuple  where  is the minimally ramified -data determined by  such that the tuple is equivalent to . The explicit relation between  and  is described later in Equation\u00a07.1.\nThe base change map in the usual sense  given by  is well-defined on the set of equivalence classes of all the Langlands parameters. However, for a discrete Langlands parameter  of a regular supercuspidal representation of ,  may not be a Langlands parameter of a regular supercuspidal representation of . Hence the base change of regular supercuspidal -packet datum is only meaningful when the datum after base change is still a regular supercuspidal parameter. Nonetheless, for a given regular supercuspidal parameter , if , then  is a regular supercuspidal parameter by Remark\u00a03.2.\nTo prove Proposition\u00a04.2, we need the following lemma.\nLet  be any gauge. The cocycle in  Equation\u00a03.7 satisfies \nThis is a direct consequence of [Kal19a, Proposition 5.15.3] by taking  to be  and  to be . This is also proved in [Sch21, Theorem 64].\n\u220e\nLet  denote the Langlands parameter of the regular supercuspidal representation associated to the tame elliptic pair . As described in Section\u00a03.2,  is of the form:Combining the above lemma with local Langlands correspondence for tori, we havewhich means the supercuspidal -packet datum associated to  is .\nIn other words, we have the following commutative diagram:\u220e\n5 Prasad\u2019s conjecture for Galois pairs\nWe give a brief review of Prasad\u2019s conjecture relating the distinction property of an irreducible admissible representation of  to the base change functorial property of its Langlands parameter and certain numerical invariants on both sides. Before going into details, we give a brief introduction to certain objects defined by Prasad. For more detailed description of these objects, one can refer to Prasad\u2019s original paper [Pra15]. Let  be a quasi-split reductive group defined over a non-archimedean local field  and  be a quadratic extension with a non-trivial Galois involution .\n5.1 The quasi-split -form  of .\nNotice that quasi-split -forms of  are classified by:Let  be the Chevalley involution, which is defined by Prasad [Pra19a] in the general case and Adams-Vogan [Ada14][AV16] independently in the archimedean case. It is a well-defined element in . If we consider the isomorphism:where  is the based root datum of , then the Chevalley involution  is nothing but the  map on , where  is the longest Weyl element.\nSince  is quasi-split, we can produce a splitting of the exact sequence over :by fixing a pinning  of  over , that is, we have a natural splitting:In this way, we get an automorphism  in  such that . Notice that the involution  does depend on the pinning we choose and a canonical choice of lift  with respect to the given pinning  has been explicitly described by Prasad [Pra19a, Definition 1, Example 1]. Fixing a Chevalley involution  whose image is  in , we get a quasi-split -form  of  defined by the element in , which sends  to .\nNotice that  is a quasi-split -form of , such that  as algebraic groups over . More precisely, we have the following description of -rational points of :where  is the canonical involution constructed in [Pra19a, Definition 1].\nLet  be a torus defined over , then there is an isomorphism between  and . In this case,  and we haveThe following cases of tori will be frequently used later:, then ., then ., for a quadratic extension  over , which is different from , then  for the quadratic extension  over , which is different from  and .\nThe complex dual group of  is equipped with a natural embedding  sending  to , which extends naturally to a homomorphism of -groups  sending  to . This functoriality realizes the base change of , which coincides with the one in Section\u00a04.1, except that we use isomorphisms  sending  to .\nWe have already seen that one of the necessary conditions for a Langlands parameter of  to be a functorial lift from a Langlands parameter of  is that the parameter is -invariant (the Galois action is the one associated to the pair ), which is well known in the following cases:\nIf  is the quasi-split unitary group, then  is the general linear group over . A Langlands parameter of  being -invariant with respect to  means . Since each -packet of  is a singleton, this simply means , that is,  is conjugate invariant.If  is the general linear group, then  is the quasi-split unitary group. Notice that the  action on  is the usual Galois action twisted by the Chavelley involution , where  denotes the matrix . In this case, a Langlands parameter of  being -invariant with respect to  means , that is, . This simply means , that is,  is conjugate self dual.In case 1, the conjugate invariant condition is also a sufficient condition for  being a base change lift from . However, in case 2, the conjugate self dual condition is not sufficient to determine whether  is a (stable) base change lift from . One needs further information, that is, the sign of the conjugate self dual representation to determine whether it is a (stable) base change or not.\n5.2 The quadratic character  associated to .\nLet  be the quadratic character of  associated to the quadratic extension  by the local class field theory. More precisely,  is given by the natural projection . Although there is a uniform description of this quadratic character in terms of local class field theory, it is still convenient for us to write down the following explicit description of this quadratic character depending on whether  is ramified or not. Notice that  could be described using the quadratic Hilbert symbol sending  to . More precisely,\nWhen  is unramified, we havewhere  is the normalized valuation on  such that .\nWhen  is ramified,  is chosen to be a uniformizer  of . Then we have\nPrasad\u2019s quadratic character  is given by the following Galois cohomological construction. Consider the short exact sequence of -groups:which leads to a long exact sequence:Notice that we also have a short exact sequencefor any maximal torus  of .\nBy the natural identificationtogether with Tate duality, we have a natural map:By Proposition\u00a03.11, we have a natural bijection:Moreover, we have the following commutative diagram:where the first vertical map is induced by the natural -equivariant morphism , and the second vertical map is given by the composition with the natural map .\nBy choosing a regular unipotent element  in , we have a map  by Jacobson-Morosov theorem. Notice that . Hence we have a map of -groups:which induces a map:The image of  under this map determines a quadratic character of  hence a quadratic character of  by the vertical map. This is exactly the quadratic character .\nNotice that the Cartier dual of the finite group scheme  over a -adic field is the constant group scheme . The corresponding Tate duality gives a perfect pairing:When , there is a natural isomorphism between  and  as trivial -modules, where the second isomorphism is given by exponential maps . Together with the isomorphism  induced by the Kummer sequenceit is convenient for us to use the following isomorphisms to parameterize the set of isomorphism classes of quadratic etale algebra over .\nFrom the bijection in Proposition\u00a03.11, it is easy to see that  is trivial if  is semisimple, simply connected, since  is adjoint so that  is trivial. Moreover, we have the following lemma describing the relationship between  and .\n\n\nLemma 5.4.\n\n\n\n\n\n\n\n\n\n\n\nIt follows from the constructions of  and , which are both constructed from a quadratic character of  and the following commutative diagram:\u220e\nAs explained by Prasad in his paper, this quadratic character is closely related to the half sum of positive root in the following manner. Let  be a quasi-split group over a local field  and  be a maximal torus of  over  contained in a Borel subgroup  over .\nLet  be the half sum of positive roots of , then . Then we have the following commutative diagramwhich gives an exact sequence of dual Galois modules\n\n\n\n\n\n\n\n\n\nHence the map , which defines Prasad\u2019s character viais the restriction of the map\nFor , the map  is given by:It is not hard to see that the principal  map induced by  is given by:such that the induced map on  is given by:For the quasi-split group  with  quadratic, the computation is similar except that the  action on  factors through , and is given byfor , which means that there is an identification .\nBy later computations in Lemma\u00a05.11 and Remark\u00a05.12, Prasad\u2019s character  is given by:where  denotes the isomorphism , and  denotes the trivial character if , and denotes the quadratic character associated to  if .\nIn fact, Prasad\u2019s character has been computed explicitly for many examples [Rap18][MO21]. The above examples are also computed explicitly in [MO21] in a slightly different way. We list some of them.\n: the quasi-split special orthogonal group,  is given by ,\nwhere  is the Spin norm given by the connecting homomorphism:associated to the short exact sequence of -groups:  is trivial, since  is simply connected.: the split special orthogonal group or the quasi-split but non split orthogonal group,  is trivial.\n5.3 The restriction of  to the elliptic maximal torus .\nNotice that the restriction of a character of  to  is a character of  for any maximal torus  of . Hence we have the following interpretation of restriction of characters of  to  in terms of Galois cohomology\nNotice that we have the following commutative diagram:which gives the following commutative diagram at the level of :Hence the image of  under the natural mapis the restriction of Prasad\u2019s character to .\nNotice that the local Langlands correspondence for tori could be regarded as an isomorphism of two functors from the category of tori over  to the category of abelian groups [Yu09] sending a torus  toHence it enjoys the following functorial property.\nLet  be a morphism of  tori, which induces a morphism of -modules . Then we have the following commutative diagram\nThe following functoriality is frequently used in the later computation.\nLet  be a finite Galois extension and  be a torus defined over . Let  be the natural embedding . Notice that one has a natural identificationsuch that  is given by the corestriction mapWe have the following commutative diagram:\nMoreover, if we apply Proposition\u00a05.7 to the case when  is a split maximal torus of  and  is a root of , we can get the following factorization of the restriction of Prasad\u2019s character to the split maximal torus.\nLet  be a split maximal torus of a split reductive group . We have the following identity:\nThis is a direct consequence of the functorial property of local Langlands for tori in Proposition\u00a05.7 and the explicit description of the map  in Equation\u00a05.1.\n\u220e\nIn fact, we can also obtain a similar factorization for the restriction of Prasad\u2019s quadratic character to an elliptic maximal torus  of . However, since there will be no Borel subgroup defined over  containing , we need to find certain replacement of the set of positive roots, which is given by a section of . In the case when  is a maximal torus contained in a Borel subgroup , both of which are defined over ,  could be regarded as a section of  determined by the . Let  be an arbitrary maximal torus of  defined over , one can choose a Borel subgroup  of  defined over  containing  such that  can be identified with  as a set, where the former set may have a non-trivial  action. Let  be the corresponding maximal torus in  such that . We have the following lemma due to Kottwitz [Kot83, Page 292].\nThe restriction of  to  is independent of the choice of , hence is defined over  and  is preserved by any automorphism of .\nHence the definition of Prasad\u2019s character also does not depend on the choice of section . Notice that  indeed inherits a  action given byfor any . We have the following identification:hence the following partition:where ,  and  stand for symmetric, asymmetric  orbits and asymmetric  orbits. This decomposition enables us to get a factorization of Prasad\u2019s character in terms of certain  orbits.\nBefore we give a general description of the restriction of Prasad\u2019s character to an elliptic maximal torus, we first prove the following lemma.\nLet  be any one dimensional torus defined over a non archimedean local field , consider the natural -equivariant inclusion  (embedding of  into ), which gives the natural map . Let  be a quadratic extension of , which is regarded as an element in . Then the image of  under the above map is the character of  given by the natural map .\nFirst we need to prove that the map  is indeed a character, that is,  could be embedded into . Notice that there are four kinds of one dimensional tori over a -adic field, when the residue characteristic is not :  and , where  are three quadratic extensions of . When  is , we have  by local class field theory. When  is , we have  by Hilbert , where  is given by . When  is  with  and , we have  and . Then we have the following identificationdue to the following isomorphism:The last isomorphism is due to the fact that the map  is trivial since .Since  acts on  trivially, we have the identificationThen the element  gives rise to a natural quadratic character of  which is trivial on the index two subgroup . Let  denote the image of  under the map . Then  is a cocycle which is trivial on . Under the local Langlands correspondence for tori,  corresponds to a character of  trivial on , which is the natural character .\u220e\nThe above quadratic character has a more convenient description in terms of quadratic characters of the splitting field of the one dimensional torus . Let  be a one dimensional torus over  with splitting field . There exists a natural embeddingwith a -equivariant morphism of dual torus given by the corestriction map in Equation\u00a05.3:Notice that we have a commutative diagramApplying the functor , we get a commutative diagram at the level of :By local Langlands correspondence for tori, the image of  is  for , where  is trivial if  is contained in , and the quadratic character associated to  if  and  are disjoint.\nIn fact, for any torus  of the form , where  is a one dimensional torus over , one can also construct the following map:The simplest example is when we take  to be . For disjoint  and , the image of  is the quadratic character . For , the image of  is trivial.\nNow we give a new interpretation of the restriction of Prasad\u2019s character to , where  is an elliptic maximal torus of . This interpretation is largely inspired by the work of Kaletha and Langlands Shelstad.\nThe following diagram of -modules is commutative:\nNotice that the  action on  is trivial. By Equation\u00a04.1, the natural map  sends  to the constant functions  on . For a  orbit  of a root , we have a natural identification . One can directly check the commutativity of the diagram by explicit computation:\u220e\nWe can apply the functor  to get a commutative diagram at the level of :Moreover, if  is symmetric, then we also have:\n is symmetric.Let  be the one dimensional anisotropic torus over  whose  points correspond to the norm-one elements of  with respect to . A  orbit of  induces a natural map . Then we consider the following diagram:One can define a character of  associated to  and the  orbit of  in the following way:sending  to , where  is the natural mapNotice that we have the following commutative diagram:where  denotes the isomorphism .\nHence we have is asymmetric.One can define a character of  associated to  and the  orbit of  in the following way:sending  to .Notice that by [Kal19a, Page 6], any root  gives a morphism , and summing over  orbit of  gives a morphism:defined over . (In fact these two morphisms are trivial on , hence define a morphism from  to  over , which is in fact trivial due to the ellipticity of .) This gives a morphism of dual toriNotice that the -mapfactors through the above map, which implies the character  factors throughHence the character is trivial.\nThe restriction of Prasad\u2019s character to an elliptic maximal torus  inherits the following factorization:\nNotice that the restriction of Prasad\u2019s character to  is given by the image of  under the following map:By Equation\u00a05.4, we haveNotice that each summand is defined over , hence we have the following factorization by Equation\u00a05.5 and Equation\u00a05.6:\u220e\nOne advantage of our formulation is that we can compute the restriction of Prasad\u2019s character to an elliptic torus  according to the property of absolute roots associated to .\nFor , computations in Example\u00a05.5 have already shown thatNow we give a reinterpretation of , where  is a maximal elliptic torus of  of the form  for a degree  extension . Since  is still an elliptic torus of , we know that . One can easily see that , which means that we haveIn this case we also have  for each root . Notice that each  orbit of roots has exactly  roots, hence the number of  orbits equals .\nHence we havewhich means thatBy Theorem\u00a05.15, we can deduce\n5.4 Prasad\u2019s conjecture for regular supercuspidal representations.\nAlthough Prasad makes his conjecture for an arbitrary irreducible admissible representation of  in a generic -packet, the conjecture has a simpler form for regular supercuspidal representations.\nFix a Whittaker datum  such that  satisfies , let  be a regular supercuspidal representation of  with Langlands-Vogan parameter , where  is the Langlands parameter of  and  is an irreducible representation of the component group . Let  be the quasi-split -form of  defined in Section\u00a05.1, and  be the quadratic character of  associated to  defined in Section\u00a05.2. Then we have the following identity:where the sum of RHS runs over all the Langlands parameters  such that , and  is the multiplicity of the trivial representation in the restriction of .\nNotice that we can simplify the parameter side of this identity based on the nice parametrization properties of regular supercuspidal representations, which will be described in detail in Section\u00a07.2.1.\nThe inflation restriction sequence Equation\u00a04.2 already implies that the set of possible extensions of  can be identified withNotice that under the twisted (by )  action, we have an identification . In fact, for a regular supercuspidal parameter , Lemma 5.3.4 in [Kal19] impliesHowever, there may exist different  structures on  (hence different  structure on ) such that  is , and we should count them all. If we fix an  structure on , then the set of possible extensions of  can be identified with the pointed setunder the above isomorphism. We will give a comparison between this and the one obtained from the naive base change in Remark\u00a07.5.\n6 Hakim-Murnaghan\u2019s formula for distinguished regular supercuspidal representations\n6.1 Yu\u2019s construction of tamely ramified supercuspidal representations.\nLet  be a reductive group over a nonarchimedean local field  of residual characteristic , such that it splits over a tamely ramified extension of . Yu develops a general method to construct tame supercuspidal representations of  using cuspidal data. We give a brief review of the construction here. For more details, one can refer to [Yu01],[HM08]. We fix an additive character  of conductor  for convenience.\nA generic cuspidal datum is a -tuple:where is a sequence of tamely ramified twisted Levi subgroups of , such that  is anisotropic. is a point in the enlarged Bruhat-Tits building of  and  denotes its image in the reduced building. is a sequence of real numbers, such that  if , and  if . is an irreducible representation of  such that  is -isotypic and  contains an inflation of a cuspidal representation of , and also - is irreducible.(The last condition is also equivalent to the condition that  is a depth-0 supercuspidal representation of .) is a sequence of quasi-characters  of  of depth , which are  generic in the sense of Yu. More precisely,  is trivial and there exists a  generic element  such that:for any , where  denotes the Moy-Prasad isomorphism:\nTo understand Yu\u2019s construction, we first need to understand the representation theory of abstract Heisenberg -groups and Yu\u2019s special isomorphism, which is crucial in the whole construction. Let  be a symplectic vector space over a finite field  such that , and  be the usual Heisenberg group associated to . More precisely,  is identified with  with multiplication given by\n[Yu01]\nA Heisenberg -group is an abstract group  which is isomorphic to a Heisenberg group  associated to a symplectic vector space  over .\nFor an abstract Heisenberg -group  with center , let  denote . The commutator map defines a symplectic form on :\nA special isomorphism on  is an isomorphism  such that the following diagram commutes:\nFix a non-trivial additive character , the Heisenberg Weil representation of  is the pull back of the usual Heisenberg Weil representation of  associated to .\nThe explicit construction of the tamely ramified supercuspidal representations [Yu01] could be described as follows.\nLet  be a maximal -split torus of ,  be an -torus containing  such that  is maximal -split, and  be the centralizer of  in . Since  is quasi-split over ,  is a maximal torus of  defined over  with maximal -split subtorus . Let  be the splitting field of  such that  is a tamely ramified extension. We have canonical inclusions of apartments:When  is quasi-split over , then  could be chosen to be the maximal torus , such that  determines the pinning of  over .\nFor an arbitrary maximal torus  defined over , which splits over a tamely ramified extension . We adopt the notation in [Yu01] and [HM08].\nLet  denote the intersectionin .\nSince  is tame, by Galois descent on Bruhat-Tits building, we have a natural identification:\nFix a cuspidal datum  such that  for a tamely ramified maximal torus , and set , Yu defines a family of subgroups of :These subgroups satisfy the following relations:Since  is of depth , hence is trivial on , so that  factors through a character of . We can get a character of  by inflation:Let  be the unique character of  such thatNotice that  has a natural structure of abstract Heisenberg group over the residue field, such that  has a natural structure of symplectic vector space over the residue field. There exists an irreducible representation  of , which corresponds to the Heisenberg representation via the special isomorphism such thatThe restriction of  to  is  isotypic.The restriction of  is  isotypic.It is also proved that  factors through the mapwhere  is the inflation of  to .\nLet  be the representation of  such that its inflation to  is . One can produce a sequence of representations  of  by inflation. More precisely, we have\n,  for , and .\nThen one can further produce a representation of  byBy [Yu01] and [Fin19], the representation - is irreducible, hence a supercuspidal representation of .\nAn important class of such representations are the so-called toral supercuspidal representations, that is, the representations with Yu data:where  is an elliptic maximal torus of  and  is a character of . As remarked by [Kal19], these representations are already general enough to include a class of supercuspidal representations called epipelegic representations, which is first constructed by Reeder and Yu [RY14] using stable vectors in geometric invariant theory. Later, Kaletha [Kal15] proved that their constructions could be recovered from Adler\u2019s construction [Adl98] when the residual characteristic  is good.\nBased on Yu\u2019s work, Kaletha provides a strategy to construct regular supercuspidal representations from a tame elliptic pair  satisfying certain regular conditions. We give a short review of his construction here. The key point to recover Yu\u2019s data from  is the following existence result of Howe factorization proved by Kaletha.\nLet  be the splitting field of , one can produce a sequence of Levi subsystem of  for a sequence of positive real numbers  and :\nSet , then one can define  to be the connected reductive subgroups of  with a maximal torus  and root system . We also set .\nA Howe factorization of  is a sequence of characters  for  such that. is trivial on . is of depth  is  generic. For ,  is the trivial character if , and has depth  if . For ,  is the trivial character if , and is a depth zero character if . In this case we usually denote it by  instead of .\nAny pair  consisting of a tame elliptic torus  and a character  has a Howe factorization .\nIf , then  is a maximally unramified elliptic maximal torus of  [Kal19, Definition 3.4.2], and  is a regular depth zero character such that  factors through . Let  denote the inflation of the irreducible Deligne-Lusztig cuspidal representation  of  to . Let  denote the canonical extension of  to  established by Kaletha with the help of  action on the corresponding Deligne-Lusztig variety. By [Kal19, Propositon 3.4.27],  could be chosen to be .\nHence, the above process associates a generic cuspidal datum  to . One can then get a regular tamely ramified supercuspidal representation of  from Yu\u2019s construction.\n6.2 Hakim-Murnaghan\u2019s formula.\nFor a tame supercuspidal representation  of  with a fixed Yu-datum, Hakim and Murnaghan [HM08] give a formula to describe the dimension of the space of  invariant linear forms on  for an involution  defined over . We can apply their machinery to the case when  is  and  is the -involution induced by  (also denoted by ).\nwhere  is certain multiplicity, and  is certain quadratic character of .\nMoreover, they also describe the relevant condition explicitly.(i.e. the condition of double coset or equivalently  such that .)\nFor toral supercuspidal representations, this formula could be even much simpler. More explicitly,  is a toral supercuspidal representation, where  and  is the representation of  attached to  through Yu\u2019s special isomorphism. For these representations, we have:\nRecently, Hakim [Hak18] transforms the relevant condition on  orbits of involutions to  orbits of involutions, that is, from double coset  to double coset  for regular supercuspidal representations, and gets a refined formula for these representations. Remark that the set of  orbits of involutions within a fixed  orbit of  can be identified with , where  is the stabilizer of  in , and it\u2019s clear that  contains  as a finite index subgroup. However, in our reinterpretation, we prefer to use the double coset  instead of  for certain reason, which also avoids the factor .\nThe following theorem (in a slightly different form) is proved by Hakim [Hak18] for regular supercuspidal representations:\nLet  be a regular supercuspidal representation of  attached to a tame regular elliptic pair , then we have:\nMore precisely, the quadratic character  has the following explicit description:In fact,  is indeed the quadratic character  in Equation\u00a06.3 given by , whereis a vector space over the residue field .\n6.3 Some facts about -adic tori.\nBefore we give a reinterpretation of the relevant condition on the set of  orbits in the  orbit of the Galois involution , we first review some basic facts about -adic tori.\n Conjugacy class.\nFor a connected quasi-split reductive group  defined over , let  be a fixed base maximal torus defined over .\nLet  and  be two maximal tori of  defined over . They are called rationally conjugate if they are conjugate by an element in . They are called stably conjugate if  and  are conjugate by an element in .\nWe have the following well-known parametrization of these conjugacy classes.\nThe set of rational conjugacy classes of maximal tori of  defined over  is in bijection with the pointed set .\nExplicitly, the bijection is given by:where  is a maximal torus of  such that .\nIn fact this identification can also be read from the long exact sequence associated to the short exact sequence of Galois pointed sets:where the set of rational conjugacy classes of maximal tori defined over  can be identified with the set . In fact, the variety  is known as the variety of maximal tori, whose rational points  parameterize the set of maximal tori of  defined over .\nThe set of stable conjugacy classes of maximal tori defined over  is in bijection with the pointed set  and there is a surjective mapwith each fiber consisting of the set of rational conjugacy classes of maximal tori inside a stable conjugacy class of maximal tori.\nNow we fix a cocycle  with . Let  be the -torus corresponding to  (regarded as an element in  by the natural map ). Notice we have an -isomorphism , where  lies in , such that  projects to . Hence we have an embedding of  into  for any choice of , such that  is a maximal torus of .\nBy the short exact sequence of -groups:we have a long exact sequencehence also a long exact sequence\nNotice we have natural isomorphisms:which means  as a set.\nMoreover, in [Re11, Section 6.2] Reeder also constructs an affine action of  onsuch that the long exact sequence gives a bijection between the set of rational conjugacy classes of maximal torus in  and the set of  orbits in .\n Rational Embeddings.\nFix a stable conjugacy class of maximal tori , there is another interpretation of the set:\nThis set parametrizes rational equivalence classes of -embeddings of a maximal torus  into , that is(two embeddings  and  are equivalent if there exists some  such that )\nIf we write  for some , we not only have  (this is the condition for  to be defined over ), but also have  for any  and any (this is the condition for  to be defined over , that is ), which means .\n\u220e\nIn the above lemma, we have already assumed that  is a maximal torus of , which means that we have already chosen a base point of an -embedding of the underlying abstract torus of  to . Moreover, if  is an abstract torus with a fixed  conjugacy class of an embedding  such that  is a maximal torus of , then the set of  is a torsor under  by sending  to  for  such that .\nNotice that the setparameterizes all the  equivalence classes of possible embeddings of maximal torus into . More precisely, this set is in bijection with the set of equivalence classes of the pairs  where  is an -torus with  and  is a  equivalence class of -embeddings.  is equivalent to  if and only if  and there exists  such that .\nIf  is an elliptic maximal torus of , then  is surjective.\nBased on this lemma, we can see that the pointed set  with  being an elliptic maximal torus of  can be identified with the set of rational conjugacy classes of -embeddings of  into all pure inner forms  of  for . For a regular supercuspidal parameter , we have already seen in Section\u00a03.4 that there is a bijection:What\u2019s more, we also have the following refined bijiection:\n6.4 Reinterpretation of the indexing set appearing in Hakim-Murnaghan\u2019s formula.\nLet  denote the  orbit of the Galois involution . For a regular supercuspidal representation  associated to  with  elliptic torus over  such that  and  is maximal torus of , the relevant condition for  being distinguished becomes that  is stable under  for some  by [Hak18]. Notice that this condition is equivalent to the condition , which means  is defined over . Let  denote this -torus, and we have  as locally compact topological groups.\nThere is a bijection between the relevant double cosetand the set , where  is defined to be:Let  be a fixed base point of an embedding of an abstract torus  to  over . Then  could be regarded as an element of  via the map . Furthermore, if  is fixed as the base point in , this set can also be identified with the set:\nNotice that  is -stable hence defined over  with . We partition the relevant double coset according to the isomorphism class of the -structure of . The bijection is given by sending  to  such that . It is clear from definition that  only depends on  and that . It is also direct to check this map is indeed a bijection. The second statement follows from Propostion (6.7), Lemma (6.9) and the following commutative diagram for elliptic torus, which is due to snake lemma:where  is the short notation for .\n\u220e\nWe can also consider the above BC map for pure inner forms  with  and these maps can be glued to a map:which coincides with the usual restriction map:Moreover we have:\nIn fact, if we choose  to be the base point in , there is a natural identification:\nIn terms of this interpretation, Hakim-Murnaghan\u2019s formula becomes:\n6.5 -extension and a reduction step.\nSince we are dealing with the distinction problem with respect to a specific quadratic character which may be nontrivial, we can\u2019t apply Hakim-Murnaghan\u2019s formula directly. An obstruction is that  could not always be extended to be a character of . To deal with this issue, we take consideration of the -extension of .\nLet  be a connected reductive group over . A -extension of  is a central extension  of :such that is a connected reductive group over  whose derived subgroup is simply connected. is an induced torus, that is,  is isomorphic to a finite product  for finite extensions .\nFor any reductive group  over a field of characteristic , a -extension always exists.\nTaking the long exact sequence of Galois cohomology associted to the short exact sequence of -groups, we have:By Shapiro\u2019s lemma, we have isomorphisms:which implies that .\nIn this way, we can treat an irreducible representation of  as an irreducible representation of , which  acts on trivially. In particular, Prasad\u2019s character  is indeed a quadratic character of .\n, as a quadratic character of , can be extended to a quadratic character of  for any -extension  of .\nWe first prove that  regarded as a character of  is the same as . Notice that we have a following commutative diagram:which leads to the following commutative diagram:The commutativity of the above diagram implies that  as a character of . By Lemma (5.4),  coincides with , which is trivial since  is simply connected. This simply means that  is a character of .Notice that we have a second exact sequence of -groups:where  denotes the derived subgroup of  and  denotes the cocenter of , which is a torus defined over .Taking the long exact sequence of Galois cohomology, we have:since  is simply connected. This provides an identification between  and . Since  is a subgroup of the locally compact abelian group ,  as a character of  could be always extended to be a character of , hence a quadratic character of .\n\u220e\nLet  be an extension of  to . Now we review the relationship between representation theory of  and . Notice that we have a natural map:by regarding an irreducible representation of  as an irreducible representation of , on which  acts trivially.\nLet  be a regular supercuspidal representation of  constructed from a tame regular elliptic pair , the image of  under this map is the regular supercuspidal representation of  attached to , where  is the preimage of  in  and  is the pull back of  along . We have the following commutative diagram:\nTaking long exact sequence of Galois cohomology, we have the following commutative diagram:\nSince  is an induced torus, we know that  and . By the snake lemma, we have an isomorphism:\nIf we fix a stable conjugacy class of an elliptic torus  in , then we have a bijection:Moreover, there is a bijection:since any -embedding  into , whose base change to  is , canonically determines an -embedding  whose base change to  is  and vice versa. Hence we have\n7 Proof of the theorem under 7.9\n7.1 Torus case.\nWe start with Prasad\u2019s conjecture for torus . This has already been treated in Prasad\u2019s paper [Pra15], and we give a brief review of the torus case here. Notice that  is trivial, hence for any  which may be nontrivial,  is identified with . From the construction of , we know that it is in fact constructed from a character of , hence is trivial in the torus case.\nLet  be a character of . The left hand side of Prasad\u2019s conjecture gives\nBy Example\u00a05.1,  is a -torus, whose -rational points are given byFrom the long exact sequence associated to the short exact sequence of -groups:we haveApplying the exact functor  of taking the Pontryagin dual, we can see that a character  of  is distinguished by  if and only if it is a base change of a character of  that is  where  is a character of  and  is the norm map associated to  given by  Hence we haveNotice that the set of possible extensions of the parameter of  (if not empty) can identified with the set . The right hand side of Prasad\u2019s conjecture reads:In fact, by local Langlands for tori and the exact sequencewe can already see that the number of base change lifts of  from  (if not ) equals the cardinality of\nNow we give a direct proof based on Galois cohomology. For the exact sequence of algebraic groups over :we have a dual exact sequence of -modulesBy combining a result of Kottwitz [Kot84, Corollary 2.3] and Shapiro\u2019s lemma, we have the following long exact sequence:which leads to an isomorphism:where the map  is induced by the corestriction map. Since  is dense in ,  for any Galois module . Hence we have the commutative diagram:Notice we have isomorphismsNotice that for a homomorphism of abelian groups , there is a natural identification . As a corollary, we have , which implies the equality\nNow we try to reduce the proof of Prasad\u2019s conjecture for regular supercuspidal representations to the case of torus.\n7.2 Regular supercuspidal case.\nWe first summarize Kaletha\u2019s construction of an -packet associated to a regular supercuspidal -packet datum in a few words.\nFix a regular supercuspidal -packet datum  of  such that  is the minimally ramified -datum determined by , the Vogan -packet associated to this Langlands parameter consists of representations:where  runs over the set of  conjugacy classes of embeddings of  into  over  for any , and the representation  is the one constructed from Yu\u2019s generic cuspidal datum associted to the tame elliptic pair in Section\u00a06.1.\nLet  be a regular supercuspidal representation associated to a regular supercuspidal datum , where  is an admissible embedding of  to  defined over . Now we give an explicit computation of LHS and RHS of Equation\u00a05.7. Notice the tame elliptic regular pair associated to this regular supercuspidal datum is . We also need the following generalization of Lemma\u00a03.9 to fix a base point in a given regular supercuspidal -packet.\nFor any Whittaker datum  for , there is a unique admissible embedding (up to  conjugacy)  such that the regular supercuspidal representation corresponding to  is -generic.\nIf the Whittaker datum  is chosen to satisfy Prasad\u2019s condition , then base point of embedding  is defined over .\nBy Lemma\u00a0A.11, the condition  is equivalent to the condition . Let  be the generic semisimple element associated to the character . Since we also assume the -parameter of  is a base change lift from one of , we have . By [Kal19, Lemma 6.2.2] [FKS21], the unique embedding (up to  conjugacy)  such that  is  generic is characterized by the condition that\nthe  conjugacy class of  meets the Kostant section of . More precisely, there exists  such that . To prove  is defined over , we need to verifyLet  denote , then we have . Notice that the facts  and  imply thatBy the uniqueness of the characterization, we have , that is,  is defined over .\n\u220e\nWe shall henceforth fix a Whittaker datum  satisfying Prasad\u2019s condition and use  in Proposition\u00a07.2 as a base point to fix the bijection:\n7.2.1 RHS of Equation\u00a05.7.\nNow we try to compute the RHS of Prasad\u2019s conjecture in Equation\u00a05.7 explicitly for regular supercuspidal representations in terms of their supercuspidal data. Notice that  plays the role of a character of component group  associated to .\nTo find an extension of a parameter  to a parameter  is equivalent to find a regular supercuspidal -packet datum  of , where  is an elliptic maximal torus of  defined over  and  is a character of  such thatThis is equivalent to the condition that there exists an abstract isomorphism of  tori:where the norm  is the composite of  and the norm map on  sending  to . We take this abstract isomorphism  as part of our initial data.\nSince  is tamely ramified, we know that . Then the second condition becomes\nA priori, it seems that the character  produced by -data depends on the character . However, the computations in Section\u00a08.4 imply that this character does not depend on , but only depends on .\nNotice that for a supercuspidal parameter , Lemma 5.3.1 in [Kal19] implies\nThe parameter side of Prasad\u2019s conjecture in Equation\u00a05.7 then becomes:where the notation  means that we fix an abstract isomorphism  of abstract tori over .\nThe  of Equation\u00a05.7 is given by:\nWe give an explicit computation of each term appearing inBy local Langlands correspondence for tori,\n We also have a commutative diagram:Hence for , the setcan be identified with a torsor for .Fix a Whittaker datum  satisfying Prasad\u2019s condition, which determines a base point  of the set of equivalence classes of rational embeddings of  to . By Proposition\u00a07.2,  is in fact defined over , and the representation  has the label  such that , which we still denote by  for simplicity. Consider the following correspondence established in Theorem\u00a07.1:The condition  (hence must be ) is equivalent to the condition\n. We also have a commutative diagramwhere the horizontal arrows are given by Kottwitz isomorphisms. Hence the condition  is equivalent to the condition By the above two interpretations of the formula, we prove that the  of Equation\u00a05.7 is given by\u220e\nComparing the number of base change lifting of supercuspidal -packet datum with the one given by inflation and restriction sequence Equation\u00a04.2, it seems that the extension of the character part of the datum is already parametrized by . In fact, the regularity condition of the character  seems to pose some constraints on the set of pair  whose base change over  is . One natural question is whether  could be a base change of  and  simultaneously such that the -structure of  and  are different. We can even see this in the following example of :Let T be an elliptic maximal torus of  over  and  be a regular character of . Then  can be identified with norm  elements inside a quadratic extension . A necessary condition for the existence of an elliptic maximal torus of  whose base change equals to  is that  is a biquadratic extension. Let  and  be the other  intermediate fields between  and . Let  denote the non-trivial involution. Then  can not be a base change of  and  with  simultaneously.If  comes from two elliptic torus  and  over  with , then there exist characters  such that  for any . A immediate consequence is that , which implies . This contradicts with the regular condition, since we have a natural identification: \n\u220eLater we will see that the same phenomenon happens on the representation side. More precisely, the regular condition may pose the condition that  can not be distinguished with respect to  and  with  simultaneously. Since these conditions are equivalent as a simple consequence of local Langlands correspondence for tori, we do not need to exclude these possibilities to prove Prasad\u2019s identity.\n7.2.2 LHS of Equation\u00a05.7.\nFor , we have a -extension of  depending on . Let  denote the -extension for . Summing these dimensions over -pure inner forms  of  which are trivial over , we have the following identity:\n\n\nProposition 7.8.\n\n\n\n\n\n\n\n\n\n\n\nWe have the following equalities of charactersfor any reductive group  whose derived subgroup is simply connected.\nIf we assume 7.9, then the proof is a direct consequence of the proof of torus case and the following comparison of Proposition(7.4) and Proposition(7.8):\nThe conditions in Proposition\u00a07.4 and Proposition(7.8) are the same.\nA stable conjugacy class of a maximal torus  of  uniquely determines a stable conjugacy class of maximal torus  of , and vice versa. By the long exact sequence associated to the short exact sequence of -groups:we haveTaking the Pontryagin dual of the above exact sequence, we can see  if and only if By the long exact sequence associated to the short exact sequence of -tori:we have \n\u220e\nPrasad\u2019s conjecture 5.17 is true for regular supercuspidal representations if and only if Conjecture 7.9 is true.\n8 Comparison of various characters\nTo prove 7.9, we need to detect the relation between the following four quadratic characters: , ,  and , where  appears in [HM08] for the computation the dimension of invariant forms,  is the restriction of Prasad\u2019s quadratic character to ,  is the the rectifying character, which is used to construct regular supercuspidal representations from  in [Kal19], and  is the character of  associated to the -data, which measures the difference of two different -data. The proof of Conjecture 7.9 is not completely done in this article, we manage to prove Conjecture 7.9 for some particular examples, and when  is unramified. A priori, it is hard to imagine there is any relation between these characters, since the constructions of these characters are of different nature. In fact, these characters are quite mysterious, and of independent interest themselves. Certain deep arithmetic hides behind these characters. We give a short summary of these characters.\nThe motivation of Prasad\u2019s character is to detect the sign of a conjugate self dual representation. More precisely, for the case of , the representations distinguished by the trivial character are conjugate orthogonal, and the ones distinguished by Prasad\u2019s character are conjugate symplectic. Hakim\u2019s character consists of two parts, both appearing in the computation of the dimension of the linear form. The first part of Hakim\u2019s character origins from different choices of Yu\u2019s special isomorphism in his construction of tame supercuspidal representations. The second part of Hakim\u2019s character appears in the depth zero part, which follows from Lusztig\u2019s work on the computation of the dimension of linear forms for finite groups of Lie type. Kaletha\u2019s character naturally appears in the construction of local Langlands for regular supercuspidal representations, which aims to produce the correct character identity based on the work of Adler, Debacker and Spice [AS09] [DS18]. The character  appears naturally measuring the difference of the base point of -embedding given by different tamely ramified -data determined by the characters of the torus. We will give a description, and sometimes a reinterpretation of these characters in detail.\nWe first recall the explicit expressions of these characters.\n Hakim-Murnaghan\u2019s character of .where \nis a vector space over the residue field .\n Kaletha\u2019s character of .\nwhere  is the toral invariant defined by Kaletha. More precisely, it is given by:where  denotes ,  denotes a nonzero element in ,  is a quadratic extension with , and  denotes the quadratic character  associated to  by local class field theory.\nIn the next few subsections, we are going to compute these characters explicitly taking into consideration of the distinction problem. For convenience, let  be a maximal torus of , and  be a maximal torus of  such that  is  conjugate to  instead of writing  and  for abstract tori  and embeddings .\nConjecture 7.9 is true when  is unramified.\nConjecture 7.9 is true for ,, ( odd) and  ( odd) for arbitrary quadratic extension .\n8.1 Prasad\u2019s character.\nBy Theorem\u00a05.15, we have the following factorization of Prasad\u2019s quadratic character:\n8.2 Kaletha\u2019s character.\nKaletha\u2019s character is given by:\nNow,  is a maximal torus of . Notice that we care about the situation when  is a base change of a maximal torus  of  over . Then we can identify the absolute character groups .\n8.2.1 Toral invariant.\nIn [Kal19], he gives a characterization of the toral invariant in terms of the Kottwitz sign of certain absolute rank  group. Now we describe his formulation.\nFor a symmetric root  over , let  denote the subgroup of  generated by the root subgroups for  and .\nWe know that  is defined over , and a semisimple group of absolute rank . If we assume  being simply connected, then the toral invariant could be understood as the Kottwitz sign of .\nwhere  is a division algebra over  and  denotes the Kottwitz sign [Kot83].\nThis is essentially proved by Kaletha. Notice that one has a decomposition of Lie algebrasuch that  is the Lie algebra of a one dimensional anisotropic torus  defined over , which splits over . Since  is simply connected, semisimple of rank  over , we know  must be an inner form of  over . From the definition of the toral invariant , we can see that . Hence the computation reduces to a computation of toral invariant of absolute rank one semisimple simply connected group. Notice that  is  by [Kal19, Lemma 4.5.3, Page 57]. By [Kal15, Proposition 4.3], we have the following formula for an inner twist  with its restriction to be an -isomorphism :We apply this formula to the case of absolute rank one group over , and get\n.In fact, we can write down a direct computation for  and  uniformly.Let  for . Let  be a quaternion algebra over , which possibly splits. Then  could be embedded into  such that  as a (right) -vector space could be written as  for  with multiplication satisfying . Then the quaternion algebra is determined by the Hilbert symbol .\nNotice that the left multiplication of  on  is  linear since  is a right  vector space. By choosing a basis  over  , one can embed  to  sending  to . Notice that  is the fixed point of  of the following involutionwhich defines the action of . Over , the adjoint action of  is given by . We can choose\n, then  and , which implies . Hence we have\u220e\nNotice that we only care about the case that  is a base change of a torus  over , and  is defined over  for the purpose of distinction. It is clear from the definition that  must be symmetric over  if it is symmetric over .If , that is,  and  are both quadratic extensions, then  is also a base change of a rank one group over . Since  splits over any quadratic extension, in particular, over , we know that .If , then the  orbit of  breaks into two  orbits:  and  for . Then we can put the toral invariant of  and that of  together, and get\n8.2.2 Explicit computation.\nWe try to compute the quadratic character  explicitly. Notice that Kaletha\u2019s character is given by a product of characters over  orbits of roots, we will deal with the component of a fixed  orbit at each time.\n is asymmetric over , then  is automatically asymmetric over , that is  and . We have two cases:The  orbit of  becomes two  orbits. In this case .Let  and  be the two  orbits, both of which contribute to the character. We can put  component and  component of Kaletha\u2019s character together. More precisely, for , that is, , we haveThe  orbit of  remains one  orbit. In this case .If  is unramified,  must be unramified.Since  is unramified, we have  for . Let  be the generator of the cyclic group , that is,Then we have:since , which means that every element in  is a square in . Hence the restriction of the character  to  is trivial.If  is ramified,  could be ramified or unramified. If it is unramified, the character is trivial by the same reason. If it is ramified, the quadratic character is given by , where  denotes the non-trivial quadratic character of . is symmetric unramified over , that is  is unramified quadratic.The  orbit of  becomes two  orbits, that is . Notice we have is asymmetric over , that is  and  is unramified quadratic.In this case, one has two  orbits. Notice that we can choose a lift  of  such that , and we only need to compute the contribution of  or  in the asymmetric case. Hence the quadratic character is given by .Since  is symmetric unramified over  in this case, we have  lies in . Similarly, let  be the generator of the cyclic group , that is,Then we havesince , which means that every element in  is a square in . Hence the restriction of the character  to  is trivial. is symmetric (necessarily unramified) over , that is  unramified quadratic extension with .In this case, one has two  orbits  and , both of which are symmetric over . We can put  component and  component of Kaletha\u2019s character together. For , that is, , we haveThe  orbit of  remains one  orbit, that is  is a quadratic extension. In this case, both  and  are unramified quadratic. Notice that we have , hence , which means  is a biquadratic extension of .In this case  is unramified and  are all ramified. Hence  is symmetric unramified over . The quadratic character is given by . is symmetric ramified over , that is  is ramified quadratic.The  orbit of  becomes two  orbits, that is . Notice we have is asymmetric over , that is  and  is ramified quadratic.In this case, one has two  orbits. Notice that  and we only need to compute the contribution of  or  in the asymmetric case. Hence the quadratic character is given by . is symmetric (necessarily ramified) over , that is  ramified quadratic extension with .In this case, one has two  orbits  and , both of which are symmetric over . We can put  component and  component of Kaletha\u2019s character together. The quadratic character is given by the toral invariant.The  orbit of  remains one  orbit, that is,  is a quadratic extension. In this case, both  quadratic and  is ramified quadratic. By the same reason  is biquadratic over  and  is unramified. is unramified. Then we have  is unramified and  is ramified, which means that  is symmetric ramified over . Hence the character is given by . is ramified,  could be unramified or ramified. is unramified, and  is biquadratic. Hence  is symmetric ramified over  and the character is given by . is ramified, and  is biquadratic. Then  is unramified, that is,  is symmetric unramified over . Hence for , the character is given by .\n8.3 Hakim\u2019s character.\nAccording to [Hak18, 3.2], Hakim\u2019s character is given by:where  is a quadratic character given by \nBefore we give a new interpretation of Hakim\u2019s character, we first list some properties of Hakim\u2019s character. These properties are mainly proved by Hakim [Hak17] [Hak18] and Zhang [Zha20a] [Zha20b].\n\nThe proof depends on the algebraic nature of this quadratic character, which means that it is the restriction of a algebraic quadratic character of , and the fact that one has a decomposition .\n factors through , where the latter is the Lusztig quadratic character defined by:where  is the sign defined by Lusztig, which is  for any reductive group  defined over .\nLet  be any  involution of  preserving . Lusztig\u2019s quadratic character has the following factorizationwhere  denotes .\nFor Galois pair,  is always trivial.\n8.3.1 A new interpretation of \nNotice that \nis a vector space over the residue field . We rewrite  as a direct sum over  orbits of roots appearing in .\n\n\n\n\n\n\n\n(8.1)\n\n\n\n\nNotice that we have isomorphisms of  vector spaces:The adjoint action of  becomes multiplication of  under this identification and the determinant is given by the norm . If we have , that is  is a jump, then  is given by , otherwise  is trivial.If  is asymmetric over , we could put the character associated to  and the character associated to  together. Notice that one has  by [DS18, Corollary 3.18], and the character is unchanged if one replaces  by . The number of  orbits of asymmetric roots is even with the same jump condition for  and . Hence the product of  over asymmetric roots is trivial.If  is symmetric over . Then the determinant of the action is given by .When  is unramified, this character is trivial sinceWhen  is ramified, this character is given by\n8.4 The character associated to -data.\n8.4.1 Relation between  and .\nNotice that , as an element of absolute root system , is the same as , but carries a twisted Galois action. More precisely, the Galois action on  could be descried as follows.\nFor any , whose projection to  is trivial,For any , whose projection is ,where  denotes the original action on , and  denotes the twisted action.\nLet  denote the subfield of  which corresponds to  under this  action, which we denote by .\n.\nWe only need to prove that . For any , we havewhich means that . The reverse direction is similar.\n\u220e\nIf  is a quadratic extension of  and  with , then  is the other intermediate field of the biquadratic extension  over .\nLet  and  be the two non-trivial elements. We havewhich impliesHence  is the third intermediate field of  corresponding to the order two element .\n\u220e\nIf  and  is both symmetric over  and . Then \nNotice that  is symmetric over , hence it is necessarily symmetric over . Hence we havewhich means that .\n\u220e\nIf  and  is symmetric over  but asymmetric over . Then .\nNotice that we have  and  over  is quadratic. Furthermore, we know  since  action on  is non-trivial. Hence , which means that  is asymmetric over .\n\u220e\n8.4.2 Explicit computation.\nThe  orbit of  remains a single  orbit.The symmetry of  is necessarily the same over  and .Symmetric case is symmetric ramified both over  and .In this case,  is also symmetric over  since  is symmetric over . Then  is a biquadratic extension of  with three intermediate fields . We have the following diagram:Under the isomorphism ,  is the trivial character on\n, the unique non-trivial character on , and is determined by its value at . Notice that  is the trivial character on , the unique non-trivial character on , and is also determined by its value at  by the surjectivity oftogether with the factThis means that  is also tamely ramified over . Hence  is trivial on , and is determined by the difference of these two -data. To compare these two -data at the symmetric ramified root  over , one only needs to evaluate the two character at  for certain mod--data over .Let  be the -data corresponding to a character , then  is also the -data corresponding to the character .This follows from the following direct computation.\u220eApply the above proposition, we know that  is given by  on . According to Bushnell and Henniart [BH05, 1.5.2], for inclusions  such that  is a biquadratic extension, we have a formula:Hence we have:which impliesBy [BH05, Lemma 1.5], for any unramified extension  of degree , . Hence , which means it is the unramified quadratic character of  associated to the unique unramified extension , which means that  is the unramified quadratic character .Hence, the  component of  is given by: is symmetric unramified over  and symmetric ramified over .\nWe have the following diagram:where  is the unramified extension of , and  is the tamely ramified -data determined by the mod  data. Notice that we haveSince  is ramified, hence we have  mod . By the fact that  is an unramified character and , we know that  is trivial. Hence we only need to compute  explicitly. is .Notice that we have  by the definition of -data, which impliesby considering the diagram:\u220eHence the  component of  is given by: is symmetric unramified both over  and .We have the following diagram:Notice that we haveby considering the diagramHence, the  component of  is given by:Asymmetric caseIf  is asymmetric both over  and . Then we have:Hence, the  component of  is given by:The  orbit of  breaks into two  orbitsThe symmetry of  is the same over  and .We have the following diagramsororNotice that the equalities  and  imply . Hence the  component of  is trivial in all these three cases.The symmetry of  is different over  and .We have the following diagrams:Notice that  since  is asymmetric over . The  component of  is given byFurthermore, we have  and  is unramified, hence the  component of  is trivial.Notice that  since  is asymmetric over . The  component of  is given bywhere  is a tamely ramified -data, which is the unique nontrivial quadratic character on  and determined by mod--data. Notice that , hence the  component of  is given by\n8.5 Tables.\nWe list tables describing the contributions of each type of roots to these four quadratic characters.\n8.6  unramified case.\nIn particular, we can use our methods to deal with all cases such that  is unramified. The unramified assumption enables us to prove many components of these characters are trivial due to some arithmetic reasons.\nPrasad\u2019s conjecture 5.17 holds for regular supercuspidal representations when  is unramified.\nPrasad\u2019s character.\nNotice that we have the following factorization of Prasad\u2019s character:for any .\nWhen  is contained in , then  is trivial.\nWhen  and  are disjoint, then . Hence the only non-trivial term is the following case:In this case,  is a biquadratic extension of . Since  is unramified, both  and  are also unramified, which means  is symmetric ramified over  and .\nHence, Prasad\u2019s character could be simplified by:\nKaletha\u2019s character.\nBy Table\u00a02, we have the following description of the character .\nIf  is unramified, we have\nHakim\u2019s character.\nNotice that  consists of two partswhere  has the following factorizationby Section\u00a08.3.1.\nNotice that  is trivial for any Galois involution by [Zha20a, Corollary 3.18], which means that\nHowever, we can not detect more information of this character from this expression. Luckily, when  is unramified,  is trivial by a result of Zhang [Zha20b, Proposition 4.1]. His proof relies on the existence of depth zero good element of trace zero, which is only available when  is unramified. In fact, his argument is global in nature which means that he constructs an  symplectic structure preserved by the adjoint action of , instead of analyzing a fixed root component of Hakim-Murnaghan\u2019s character. His method is somehow complementary to ours. Hence when  is unramified, we have:\nThe character associated to -data.\nBy Table\u00a04, we have the following description of the character of  associated to -data.\nIf  is unramified, the character is simply given by:\n\n\n\n\n\n\n\n\n\nSummarizing the above computation, we haveIn this case, both  and  are symmetric ramified over , and the above computation implies Conjecture 7.9 is true when  is unramified.\n\u220e\n8.7 Examples.\nIn this section, we apply our method to various examples and give a new proof of Prasad\u2019s conjecture for regular supercuspidal representations of these groups. Although most of these results are not new, our method is still somehow illuminating.\nPrasad\u2019s conjecture 5.17 holds for regular supercuspidal representations of ,, ( odd) and  ( odd).\n8.7.1 Example of .\nIn the case of , Prasad\u2019s character is trivial since  is simply connected and perfect. Hakim\u2019s character is also trivial since  is always a square. In fact, we can list all the possible cases of regular toral supercuspidal representations here. We also provide a comparison between our new interpretation of Hakim\u2019s character in Equation\u00a08.1 and the original one given by taking determinant of the adjoint action.\nLet ,  with . Let , so that we have the following biquadratic extension: can be embedded into  in the following two ways:..These two embeddings are -equivalent. More precisely,  maps  to . However, the intersection with  of these two elliptic maximal tori are different:Hence it indeed happens that there are different  structures of , which means that the sum over abstract torus with different -structure in our formula is not trivial a priori.Let  be the split maximal torus of  over  with  consisting of diagonal matrices. Let  be the anisotropic maximal torus of  over  with , together with an embedding (there are two rational conjugacy classes of  embeddings of  into ) given by:Let  (In fact we can even choose an element , here we use  for simplicity). Then we havethat is, .Let  be the apartment associated to  of the building , we have identificationsSince  is split,  acts trivially on  andNotice that  and  are related by . By the -equivariant property of the Bruhat-Tits building , we have:The condition  implies that  is the origin  of . Hence we have , which is a point in .Now we restrict ourselves to the toral case (every tame supercuspidal representation of  is of depth zero or toral), that is, the twisted Levi sequence is , we describe the group  and  explicitly. Such computations have essentially been done by Hakim and Lansky in [HL10].Let  be the depth of the generic element  over , which corresponds to  via . We fix a valuation  on  such that . Let , the valuation of  forces the conditionWe have:where .\nLet  denote the symplectic vector space over , where the Moy-Prasad isomorphism between  and  is realized by Caylay transform [HL10, A.6]. ramified, .  unramified,  is odd, . unramified,  is even. ,where  is endowed with a natural symplectic structure associated to an additive character such that .In fact, we can compute the action of  on  explicitly (although we actually restrict the action to  on ). If we choose the isomorphism , the action of  is given by:One can see that  (mod  is , since we have .Now we use  as an example to show how to compute Hakim\u2019s character using our reinterpretation in Equation\u00a08.1. In this case,  is symmetric both over  and . In particular, we have , ,  and . Furthermore, we havetogether with an isomorphismOne can check directly that the adjoint action of  is simply given by multiplication by  under the above isomorphism, and taking the determinant of the adjoint action mod  is simply given bywhich implies the triviality of .\nNotice that in the case of ,  is always symmetric over . By our interpretation 8.3 or [Kal19, Lemma 4.5.3], the toral invariant of  is always trivial. Hence Kaletha\u2019s character is trivial by the triviality of the toral invariant in the symmetric ramified case, together with the fact  in the symmetric unramified case. Hence the only remaining part is the computation of character of -data. Notice that the computation of  is exactly the same as the case of . By Equation\u00a08.10, Equation\u00a08.12, and Equation\u00a08.13, we have  or , both of which are trivial. Hence, Conjecture (7.9) is true for , which gives a proof of Prasad\u2019s conjecture for regular supercuspidal representations of .\n8.7.2 Example of .\nThe difference in treating the case of  and  shows different complexity of Prasad\u2019s conjecture. For the case of , the double coset part, which is related to the set of certain embeddings of tori, is more complicated, while the character part is relatively easy. However, for the case of , the non-trivial quadratic character associated to  appears, while the embedding part is easy since there are not so many equivalence classes of rational embeddings.\nLet  be an elliptic maximal torus of  over . Then  for a quadratic extension . A necessary condition for the existence of an elliptic maximal torus of  whose base change equals to  is that  is a biquadratic extension. Let  and  be the other  intermediate fields between  and . Let  denote the non-trivial involution. Then  For simplicity, let  be a torus over , whose base change to  is  with .\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nIn the case of , Prasad\u2019s quadratic character is given by:\nHence  is given by:\nWe will give an explicit computation of the case of . Before doing this, we first review some results on the descriptions of supercuspidal representations of , which arises as base change of irreducible representations of . These results are essentially due to [Bla10].\nAssume  is ramified, and  is unramified. Then  could be unramified or ramified. Let  be a character such that  is a regular supercuspidal representation of  associated to . Assume  is a base change from a Langlands parameter of . Then  is a base change of a torus  with , and  is a base change of , which means that .\n is odd if and only if we have the field diagram\nThis result has been mentioned in [Bla10]. We write down a proof for completeness.. This direction is relatively easy. Let  denote the depth of . Let  be the generic element associated to , that is,Since , we know that , in particular, . This is equivalent to the fact  mod . We can choose a uniformizer  of  such that  and . The condition  forces  to be odd.. The direction is suggested by Blasco. Since  is unramified, we can choose  to be a uniformizer  of . Since  is ramified, we can choose  to satisfy . Since  corresponds to a level  character,  is a unit. On the other hand, since  is odd, we have , which means that . However  does not lie in , hence does not belong to , which means  generates  over . This implies  is unramified, hence  is ramified.\u220e\nNow we give a comparison of these four characters in the case of .\nThe odd case. (This terminology is from [HM02]) Representation side:In this case, by the above lemma, we know that  is even, which means that there is a non-degenerate Heisenberg quotient and  belongs to :Notice that both of these two characters are trivial on  since  for . On , the product of these two characters is given by:Explicit computation shows that these two non-trivial quadratic characters coincide on , which means: Parameter side.Notice that we have , withMoreover, we have  and . The commutative diagram:becomesand  is given by  for any  or .In this case,  is the unramified quadratic character of  and , where  is the unramified quadratic character of . Hence we have  and we haveHence we have the equalityThe even case. There are two cases: Representation side.A priori, if , we haveIt is clear that  is trivial on  and given by  for . Notice that  satisfiessince , and is given by  for . Moreover, we have the following indentitywhich means that if , then we have .However, in this case,  is odd, which means that  and the Heisenberg quotient is degenerate. Hence Kaletha\u2019s character and Hakim\u2019s character are automatically both trivial in this case. Parameter side.Following Equation\u00a08.5, , where  is the quadratic character of  determined by mod  data, and  is the unramified quadratic character  of . Hence . Now we are going to proveNotice that we have  by the definition of -data, which impliesby consideringHence we also have the equality Representation side.A priori, if , then we haveNotice that  is trivial by Example\u00a08.17 in this case, which means Hakim\u2019s character is always trivial. Parameter side.By Equation\u00a08.2, we have . Hence we have\nPrasad\u2019s conjecture 5.17 holds for regular supercuspidal representations of .\nIt seems that our approach is quite different from the proof existing in the literature. These characters may not be seen explicitly in the trace formula approach or in the local Rankin-Selberg method even in the simple case of .\n8.7.3 Example of ,  is odd.\nLet  be the elliptic maximal torus  of , where  is a degree  extension of . Since we are considering the case when  is also elliptic,  and  are disjoint. Let  denote the composite of  and . Fix a set of representatives  of . One can diagonalize the element  over , such that , where  lies in . Then each root in  is of the form . When  is cyclic generated by , then  is simply . Since  is odd, we know that all the roots are asymmetric both over  and . In this case, we have , . In this case, we have . All the roots in  are symmetric over  but asymmetric over . In this case, we have  and .\nPrasad\u2019s character.\nPrasad\u2019s character is trivial, since  is odd. The fact that the restriction of Prasad\u2019s character to an elliptic maximal torus is trivial can also be seen from Example\u00a05.16. Since all the roots are asymmetric over , when  is odd.\nHakim\u2019s character.\nHakim\u2019s character is also trivial by Section\u00a08.3.1, since all the roots are asymmetric over , when  is odd.\nKaletha\u2019s character.\nA priori, it seems that Kaletha\u2019s character is not necessarily trivial from its definition. Notice that all the roots are also asymmetric over . Hence from its definition, the character  is given by\nLet  be a maximal elliptic torus of . The character  is trivial, if  is of odd ramification degree.\nNotice that  is character of  defined over , which is trivial due to the ellipticity of .\nHence we have:where  is the  orbit of , and can be identified with . Hence if  is odd, we have .\n\u220e\nNotice that all the elliptic tori of  is of the form , for a degree  extension . Hence by the above lemma, Kaletha\u2019s character  is trivial when  is odd, and so is .\nCharacter from zeta data.\nSince all the roots are asymmetric over , by Equation\u00a03.9, the character is\nNotice that  since  is asymmetric over . We only need to compute . We can choose  in its orbit such that  for some . We have the following cases.\n is unramified.  is given by . Notice that  since both  and  are unramified. Hence for , . is ramified.  is given by , where  is the tamely ramified character, which is the unique non-trivial character on  and determined by the value at some mod--data.\nNotice that for any , . is ramified. , which means the character is trivial. is unramified. , since  is odd.\nThe above computation shows that 7.9 is true for , when  is odd. This also gives a simple proof of Prasad\u2019s conjecture 5.17 for regular supercuspidal representations of  when  is odd.\n8.7.4 Example of   is odd. \nNotice that  is an elliptic maximal torus of , hence  is of the form  for a degree  extension . Hence we have  for a degree  extension  such that . Moreover, we have , , which means all the roots are asymmetric over  but symmetric over . We also know that . Moreover, we have , which means all the roots in  are asymmetric over .\nPrasad\u2019s character.\nNotice all the roots are asymmetric over , since . Hence we have . Prasad\u2019s character is trivial by Equation\u00a05.2. The fact that the restriction of Prasad\u2019s character to an elliptic maximal torus is trivial can also be seen from Theorem\u00a05.15, since .\nHakim\u2019s character.\nThe only possibility for Hakim\u2019s character to be non-trivial is that  is ramified quadratic by Section\u00a08.3.1. In this case Hakim\u2019s character is given bySince  is ramified, the reduction mod  of  is . Hence the reduction of  is , which means Hakim\u2019s character is trivial.\nKaletha\u2019s character.\nNotice that . By the argument in Lemma\u00a08.20, Kaletha\u2019s character  is trivial when  is odd, so is .\nCharacter from zeta data\nSince all the roots are asymmetric both over  and , by Equation\u00a03.9, the character is\nThe above computation shows that Conjecture 7.9 is true for , when  is odd. This also gives a simple proof of Prasad\u2019s conjecture 5.17 for regular supercuspidal representations of  when  is odd.\nAppendix A Whittaker model for distinguished regular supercuspidal representations\nIn this appendix, we collect some facts about the characterization of Whittaker models of regular supercuspidal representations in terms of geometry. This origins from the work of Debacker and Reeder [DR10] on description of Whittaker models for generic very cuspidal representations. Basically, one can describe all the characters  of  which occur in  in terms of certain intersection property between the Kostant sections of  and the  orbit of the generic element associated to . Some of these work is generalized to regular supercuspidal representations in [Kal19] and [FKS21]. We will also mention some results about the Whittaker model of a  distinguished representation of . These results interact naturally when we study the distinction problem of a regular supercuspidal representation of .\nA.1 Local character expansions.\nWe first review some basic facts about the character expansion and -adic analogue of Rossman\u2019s character formula, which is known as the Murnaghan-Kirillov formula [Mur96]. Later, this work has been extended to a more general setting by many people: Jeffrey Adler, Stephen Debacker, David Kazhdan, Loren Spice [AD04] [DK11] [AS09] etc. Fix a -invariant bilinear form  on , which identifies  with . For any regular semisimple element , let  denote the semisimple orbital integral:where  denotes the centralizer of  and  is a left invariant Haar measure on  defined by Rao [Rao72], depending on a choice of Haar measures on  and . Notice that  is a distribution if we vary , while it could also be regarded as a function on  if we fix  and vary . We use  and  to distinguish them.\nFix an additive central character , one can define the Fourier transform of arbitrary orbital integral by:where  is defined by:Notice that the Fourier transform of a nilpotent orbital integral  as a distribution could also be represented as locally constant function on an open dense subset , which we also denote by .\nLet  denote the character distribution associated to an irreducible admissible representation . More precisely, fix a Haar measure  on , for any ,where  is an operator defined byIt is known that  is represented by some locally constant function on an open dense subset of , which we still denote by . Moreover, we have the well-known local expansion formula of , which is essentially due to Harish-Chandra and Howe [DP99].\nThere exist constants  and a neighbourhood  of  in  such that, for any where  is a semisimple element of , , and  runs over all the nilpotent  orbits in .\nFor , this formula is the usual Harish-Chandra character expansion:as an equality of locally constant function in a small neighbourhood of .\nIn fact, semisimple orbital integrals and nilpotent orbital integrals both play an important role in the space of invariant distribution on . Moreover, they are related by the following germ expansion result of regular semisimple orbital integral by Shalika [Sha72].\nFor any , there exist locally constant functions  on  and a neighbourhood  of  in  such that for any ,\nFor a fixed  sufficient close to , this identity is an identity of distributions on :A priori, this identity has nothing to do with representations. In fact, we could expect more for the relationship between character expansions and Shalika germs expansions. For instance, if we admit the philosophy of orbit method in the spirit of Kirillov-Rossmann [Ros78] for real reductive groups, that is, for some particular discrete series representation , we can associate a semisimple elliptic element  (in fact a coadjoint orbit in ), one can relate  and .\nMurnaghan [Mur96] studies the relation of  and  and found thatfor arbitrary nilpotent orbit , which leads to a formula of Kirillov-Rossmann type.\nwhere  is a regular elliptic element associated to the supercuspidal representation .\nA.2 Kostant section.\nLet  be a regular nilpotent  orbit. Let  be a nilpotent element. By Jacobson Morozov theorem, there exists a  triple  such that:\nA Kostant section of  at  is an affine subspace  defined by:\nSince  and  are -rational, the Kostant section  is defined over .\nEvery regular  orbit  meets  in exactly one point.\nMoreover, if the  orbit  is also defined over , then the unique point in  is -rational. Hence the Kostant section  determines an -rational point in every regular  orbit.\nLet  be a regular  nilpotent orbit in ,  be a Kostant section for , and  be a regular semisimple element in . Then the coefficient  is non zero if and only if the  orbit of  meets \nIf  is a very supercuspidal representation associated to a tame elliptic pair , let  denote the good semisimple element with . We have the following theorem due to Debacker and Reeder.\nLet  be a regular supercuspidal representation of . Assume  is a hyperspecial point. For any generic character ,  if and only if  orbit of  meets .\nFrom another perspective, if we pick up a generic representation  of  which is  distinguished, one has the following expectations on the Whittaker model of  from Prasad.\nLet  be an irreducible generic representation of . If  is  distinguished, then  has a Whittaker model with respect to a character .\nThis conjecture has been proved by Anandavardhanan and Prasad for  [AP16] based on the study of the restriction of representations of  to  and the classification of representations of . Later, this type of question has been raised and treated in a paper of Dipendra Prasad [DS19] with an appendix by Sakellaridis for general symmetric spaces. Later, Gourevitch and Sayag [GS20] give another proof by carefully studying the geometry of coadjoint orbits sitting inside the image of moment map.\nWe have the following characterization of generic characters , such that .\nNotice that we have the following exact sequence of -groups:Since  is unipotent,  is trivial. The long exact sequence gives the isomorphismLet  denote the compositionNotice that any generic character  is of the form . More explicitly,  is defined by:where  is a fixed additive character of .\nLet  denote the -group , whose -rational points consist of trace zero elements in where  denotes the map  sending  to . Let  denote a chosen trace zero element such that , we have the following exact sequence\nNotice that we have an exact sequence of -groups:Since  is trivial, the long exact sequence implies the lemma.\n\u220e\n satisfies  if and only if .\nBy A.1, we know that  if and only if . By applying the exact functor  to A.2, we know  if and only if  is a lift of a character of , that is,  is of the form  for some character  of . This in turns implies that . The reverse direction easily follows from the surjectivity of the trace map  sending  to .\n\u220e\nBy [DR10, 4.5], one has the following assignment:where  is defined byfor any . This implies that the element  associated to  satisfies the condition\nIn fact, if  is a regular supercuspidal representation of , which is  distinguished, the results of Prasad [DS19] on the description of Whittaker model for  could be regarded as a reverse direction of Proposition\u00a07.2.\nFaculty of Mathematics, Technion, Haifa, Israel\nEmail address:wangchuijia@u.nus.edu"]}
{"qa_pairs": "none", "llm_output": ["This paper presents a modular semantics for combined logics, using partial non-deterministic logical matrices (PNmatrices). It provides a solution to the problem of combining the semantics of two logics, which is close to the abstract idea of Gabbay\u2019s fibring function. Three applications are developed taking into account the semantic characterizations, including the construction of a semantics for strengthening a given many-valued logic with additional axioms, studying conditions under which the problem of obtaining a calculus for a logic may be split into the problem of obtaining axiomatizations for suitable syntactically defined fragments of the logic, and having a clear semantics for combined logics which is crucial for studying their decidability."], "output": ["Modular many-valued semantics for combined logics\u2020\u2020thanks: Research funded by FCT/MCTES through national funds and when applicable co-funded by EU under the project UIDB/50008/2020.\n\n\nCarlos Caleiro and S\u00e9rgio Marcelino\n{ccal,smarcel}@math.tecnico.ulisboa.pt\nSQIG - Instituto de Telecomunica\u00e7\u00f5es\nDep. Matem\u00e1tica - Instituto Superior T\u00e9cnico\nUniversidade de Lisboa, Portugal\n\n\n1 Introduction\nModularly putting together logics, or their fragments, namely by joining corresponding calculi, while keeping control of the metatheoretic properties induced and, in particular, of the resulting underlying semantics, is the core idea of the general mechanism for combining logics known as fibring\u00a0[38, 40, 65, 18, 25, 24].\nGiven its fundamental character and abstract formulation, this mechanism is a key ingredient of the general theory of universal logic\u00a0[12, 14]. Further, due to its compositional nature, a deep understanding of combined logics is crucial for the construction and analysis of complex logics, a subject of ever growing importance in application fields (see\u00a0[37], for instance). Given logics  and , fibring combines them into the smallest logic  on the combined language which extends both  and . This simple idea, however, is far from well understood, to date, despite the long track of work on the subject. An interesting running example of the difficulties at hand consists of the combination of the conjunction-only and disjunction-only fragments of classical logic, which does not coincide with its conjunction-disjunction fragment (see, for instance,\u00a0[15, 21, 46]), and which we will also address.\nTo date, we have many interesting general results regarding conservativity, decidability, finite model properties, or interpolation, as well as soundness and completeness preservation with respect to different forms of symbolic calculi\u00a0[39, 23, 67, 68, 34, 10, 18, 25, 60, 65, 76, 30, 63, 51, 52]\nfor combined logics, but there is no generally usable tool support for the obtained logics, due mainly to the absence of a satisfactory semantic counterpart of fibring that naturally relates models of the component logics with models of the combined logic. With the honorable exception of fusion of modal logics\u00a0[70, 74, 41, 35, 48], a very particular case of fibring, the available general semantics for combined logics, so far, are either not constructible from the semantics of the component logics\u00a0[76, 67, 60] (due to the use of fullness assumptions), or use highly uncommon semantic structures\u00a0[66, 63].\nFor these reasons, general fibred semantics is still an open problem: how to combine, in the general case, the semantics  (adequate for logic ) and  (adequate for logic ) into a semantics\n built directly from  and , providing an adequate semantics for\n? We have known for some time that this question is far from straightforward. Namely, when taking logical matrices as models, as is most common, we know that combining two logics, each given by a single finite matrix, can result in a logic that cannot even be given by a finite set of finite matrices, nor by a single matrix, even if infinite\u00a0[52, 22]. This fact led us to considering non-deterministic logical matrices (Nmatrices), as introduced by Avron and coauthors\u00a0[4, 5], and in\u00a0[53] we understood how this expressive gain could solve the problem in a neat way, but just for disjoint combinations, that is, when the logics being combined do not share any connectives.\nIn this paper, finally, we define a simple and usable general semantics for combined propositional-based logics. We do so by further enriching our semantic structures with partiality, and adopting partial non-deterministic logical matrices (PNmatrices), as introduced in\u00a0[8]. As we shall see, the added expressivity brought by partiality is crucial not just in keeping our semantic structures as compact as possible, but mostly in dealing with shared language.\nOur work has an additional fundamental ingredient. We consider a very enlightening step forward from traditional Tarski-style  single-conclusion consequence relations (see\u00a0[73]) to Scott-like  multiple-conclusion consequence relations as introduce in\u00a0[64]. This abstraction really sheds new light into the overall problem, as shall be made clear.\nWe will thus show that semantics for combined logics can always be obtained in the form of a PNmatrix obtained directly from given PNmatrices characterizing the original logics. Further, the resulting semantics will be finite as long as the given PNmatrices are finite, at least in the setting of multiple-conclusion logics. The connections between single-conclusion and multiple-conclusion consequence relations (see\u00a0[69]) are fundamental, at this point, in understanding how much more demanding it is to obtain a similar result in the single-conclusion setting, where indeed finiteness may be lost.\nOur approach is anchored on the observation that semantics, be they given by means of matrices, Nmatrices, or PNmatrices, are simply clever ways of defining suitable collections of bivaluations (see\u00a0[13]). Since a collection of bivaluations characterizes in a unique way a multiple-conclusion logic (see\u00a0[69]), it is relatively simple to express the combination of multiple-conclusion logics in terms of bivaluations. Then, we just need to come up with a matching construction over PNmatrices, generalizing the finiteness-preserving strict-product operation proposed in\u00a0[53]. The single-conclusion case is harder, simply because the characterization of a Tarski-style consequence in terms of bivaluations is no longer unique. The situation can be restored, however, when the\ncollection of bivaluations is meet-closed, once we consider a simple (though not finiteness-preserving) corresponding operation over PNmatrices. Furthermore, we show that the constructions above enjoy universal properties, consistent with the definition of  as the least logic that extends  and , as advocated in\u00a0[65, 18].\nBesides providing a range of meaningful concrete examples, we also explore three concrete applications of the semantic characterizations obtained, which can be seen as relevant contributions in their own right: a semantic characterization of logics obtained by imposing new axioms to a given many-valued logic (with some perhaps surprising consequences, such as a denumerable semantics for intuitionistic propositional logic); an analysis of when and how to split a logic into syntactical fragments whose combination is the original logic, as a method for obtaining a calculus for a given many-valued logic by putting together axiomatizations for simpler syntactic fragments; and some general, preliminary, results on the preservation of decidability when combining logics.\nThe rest of the paper is organized as follows. In Section\u00a02 we recall the necessary notions, namely regarding logics, their syntax, semantics and calculi, and define the relevant notions regarding combined syntax and combined logics, along with examples illustrating the particularites both of single-conclusion versus multiple-conclusion consequence, and of partiality and non-determinism. The section is a bit long, but the reader can browse through faster, and come back for details when necessary. Section\u00a03 is devoted to the main contributions of the paper, namely the semantic characterization of combined logics in terms of bivaluations, and PNmatrices, first in the multiple-conclusion setting and then in the more complex single-conclusion scenario, by means of simple strict-product and -power operations on PNmatrices. Section\u00a04, then, shows that the characterizations previously obtained enjoy natural universal properties. Section\u00a05 showcases the three mentioned applications of our characterization, including some relevant important contributions by themselves. The paper concludes, in Section\u00a06, with a summary of the results obtained, their implications, and an outlook of further research.\n2 Logics and their combination\nWe start by introducing our main objects of interest, fixing notation, and setting up the technical framework necessary for studying the semantics of combined logics, as well as of their associated calculi and semantics.\n2.1 Syntax\nThe syntax of a (propositional) logic is defined, as usual, by means of a signature, an indexed family  of denumerable sets where each  contains all allowed -place connectives, and an infinite denumerable set  of variables (which we consider fixed once and for all). As standard,  denotes the set of all formulas111In our setting, the set  of all formulas is always denumerably infinite. This is not just a (relatively common) choice. This cardinality constraint plays an essential role in some technical results, where it is crucial to avoid the pitfalls of ill-defined natural extensions as observed in\u00a0[32, 28]. constructed from the variables in  using the connectives in . We will use  to denote variables,  to denote formulas, and  to denote sets of formulas, in all cases, possibly, with annotations.\nWe use , ,  to denote, respectively, the set of variables occurring in , the set of subformulas of , and the head constructor of , given a formula . These notations have simple inductive definitions: , and  for ; and if  and , , , and\n. These notations extend to sets of formulas in the obvious way.\nAs we will consider combined logics, with mixed syntax, we need to consider different signatures, as well as relations and operations between signatures.\nSignatures being families of sets, the usual set-theoretic notions can be smoothly extended to signatures. We will sometimes abuse notation, and confuse a signature  with the set  of all its connectives, and write  when  is some -place connective . For this reason, the empty signature, with no connectives at all, will be simply denoted by .\nLet  be two signatures. We say that  is a subsignature of , and write , whenever  for every . Expectedly, given signatures , we can also define their shared subsignature\n, their combined signature , and their difference signature . Clearly,  is the largest subsignature of both  and , and contains the connectives shared by both. When there are no shared connectives we have that . Analogously,  is the smallest signature that has both  and  as subsignatures, and features all the connectives from both  and  in a combined signature. Furthermore,  is the largest subsignature of  which does not share any connectives with .\nA substitution is a function , that of course extends freely to a function  for every . As usual, we use  to the denote the formula that results from  by uniformly replacing each variable  by , and  for each .\nNote that if  then . Still,  and  are both infinite denumerable. In fact, the pair can be endowed with a very useful bijection capturing the view of an arbitrary  formula from the point of view of , the skeleton function  (or simply , or even ), whose underlying idea we borrow from\u00a0[52]. Note that, given ,  may be in , in which case we dub  a -monolith or simply a monolith. The idea is simply to replace monoliths by dedicated variables, just renaming the original variables. Let  be the set of all monoliths. It is easy to see that  is always denumerable, though it can be finite when  contains nothing but a finite set of -place connectives.\nIn any case,  is always infinite denumerable, because  is, and thus we can fix a bijection . The\n bijection is now easily definable from , inductively, by letting  for , and for  and ,\n if , and  if .\nThe  bijection thus defined can be easily inverted by means of the substitution  (or simply , or even ) defined by . Note, namely, that  for every .\nNote also that the restriction of  to ,  (with a slight abuse of notation, we will use the same name) is a substitution, and  for every .\n2.2 Consequence relations\nWith respect to the very notion of logic, we will not only consider the traditional Tarski-style set-formula notion of consequence (single-conclusion), but also the more general Scott-style set-set notion of consequence (multiple-conclusion), which plays an essential role in our results.\nA multiple-conclusion logic is a pair  where  is a signature, and  is a consequence relation satisfying the properties below, for every  and :if  then , if  then , if  for each partition222Here and elsewhere,  is partition of  if  and .  of , then , if  then . \nOften, the relation also satisfies the following property, for every :\nif  then there exist finite sets  and\n such that .\nProperty (C) is best known as cut for sets.\nThe other properties are usually known as overlap (O), dilution (D), substitution invariance (S),\nand compactness (F)\n(see\u00a0[64, 69, 73]). As is well known, a multiple-conclusion logic  has a compact version\n defined to be the largest compact logic such that .\nA pair of sets of formulas  is said to be a theory-pair of  (see\u00a0[16]) when, for every , if\n then , and also, if\n then . It is clear that, given sets , the pair of sets\n is the least theory-pair containing .\nA theory-pair  is consistent if  (otherwise, by dilution, we necessarily have ). A consistent theory-pair is maximal if there is no consistent theory-pair that properly contains it, that is, if  is a consistent theory with  and  then  and . Equivalently, using cut for the set of all formulas, a consistent theory-pair  is maximal precisely if  is a partition of . This implies, obviously, that a consistent theory-pair can always be extend to a maximal one.\nWe say that a pair  is a single-conclusion logic if  is a signature,  is a relation, and  is a multiple-conclusion logic where, for ,  if and only if there exists  such that . It is well known (see\u00a0[69]) that this constitutes an alternative definition of the usual notion of Tarski-style consequence relation, inheriting the usual properties of reflexivity, monotonicity, transitivity, and structurality from properties (ODCS), as well as compactness from (F), when it holds. Again, a single-conclusion logic  has a compact version\n defined to be the largest compact logic such that .\nMore standardly, now, a set of formulas  is said to be a theory of \nwhen, for every , if  then .\nGiven a set , we know that  is the least theory that contains .\nAs usual, a theory  is consistent if . A consistent theory  is maximal relatively to  if every theory that properly contains  must also contain , that is, if  for every . A consistent theory  is relatively maximal if it is maximal relatively to some formula .\nAccording to the usual Lindenbaum Lemma (see, for instance,\u00a0[73]), if a single-conclusion logic is compact then a consistent theory always has a relatively maximal extension.\nEvery multiple-conclusion logic  has of course a single-conclusion companion defined simply by  where, for ,  if and only if .\nWhen  is a single-conclusion logic, it is clear that the single-conclusion companion of\n is precisely . There may however be many multiple-conclusion logics whose single-conclusion companion coincides with\n, which we dub as multiple-conclusion counterparts of . Indeed,\namong the many possible multiple-conclusion counterparts of , we have that  is precisely the minimal\u00a0[69].\nNote that whenever , it is easy to see that  is a theory of\n if and only if there exists  such that the pair  is a theory-pair of .\nFor both types of logics (we will use  as a placeholder for either a multiple-conclusion  or a single-conclusion ), it is well-known that the logics with a common signature form a complete lattice (under the inclusion ordering on the consequence relations), as in both cases it is relatively straightforward to check that intersections of consequence relations are consequence relations (see\u00a0[73, 69]). These facts make it relatively easy to enrich the signature of a logic. Namely, if  and  is a logic then the extension of  to , denoted by\n, is the least logic (of the same type) with signature  such that\n.\nIt is relatively simple to see that . Just note that for each substitution  we have that  is also a substitution, and also . The fact that  are bijections make it straightforward to show that  is indeed a consequence relation of the correct type.\nLet . Concretely, in the multiple-conclusion case, we have that  if and only if  if and only if there exist  and  such that , , and .\nAnalogously, in the single-conclusion case, we have that  if and only if  if and only if there exist  and  such that , , and .\nIt is also quite natural to formulate the combination of logics (also known as fibring) as follows.\nLet .The combination of type-conclusion logics , , which we denote by\n, is the least type-conclusion logic  such that . The combination is said to be disjoint if .\nNote that it follows easily that the combination of compact logics is necessarily compact. Namely, if ,  are compact then the least logic such that  is also the\nleast logic such that . Since it is clear that , it follows that .\n2.3 Calculi\nLogics are often defined by syntactic means, using symbolic calculi. Again, we will consider multiple as well as single-conclusion calculi.\nA multiple-conclusion calculus is pair  where  is a signature, and  is a set of (schematic) (multiple-conclusion) inference rules, each rule  being usually represented as  where  is the set of premises and  the set of conclusions of the rule, also represented as  when  and . We can easily associate a multiple-conclusion logic  to a given calculus  by means of a suitable tree-shaped notion of derivation (see\u00a0[69, 54, 19]). For the purpose of this paper, however, it is sufficient to characterize  as the least multiple-conclusion logic such that , being compact when the rules in  all have finite sets of premises and conclusions.\nA single-conclusion calculus is pair  where  is a signature, and  is a set of (schematic) (single-conclusion) inference rules, each rule  being usually represented as  where  is the set of premises and  the conclusion of the rule. It is clear that single-conclusion calculi can be rephrased as particular cases of multiple-conclusion calculi, namely those whose rules all have singleton sets of conclusions, and that the corresponding notion of derivation will now be linear-shaped, and coincide with the usual notion of proof in Hilbert-style calculi, giving rise to an associated single conclusion logic . Again, in any case,  is the least single-conclusion logic such that , and again it is finitary if all the rules in  have finitely many premises. In that case, if we use  for both a single conclusion-calculus and its singleton-conclusion multiple-conclusion rephrasal, it is straightforward to see that\n.\nWhen  and  is a calculus, it is immediate that , that is, the extension of  to  is precisely .\nCombining calculi at this level is quite simple, as has been known for a long time in the single-conclusion case\u00a0[17]. The logic associated to joining the rules of two calculi is precisely the combination of the logics defined by each calculi.\nLet .If  are type-conclusion calculi,  their associated type-conclusion logics, then .\nThe reasoning is straightforward. Let , which means that  is the least consequence with .As  and  it follows that , and since  is the least\nconsequence with this property we can conclude that .Reciprocally, as  it follows that , and since  is the least consequence with this property we can conclude that .\u220eFor simplicity, whenever  (in either the single or the multiple-conclusion scenarios), we will say that  constitutes an axiomatization of the logic .\n2.4 Semantics\nAnother common way of charactering logics is by semantic means. For their universality we shall consider logical matrices, but will consider an extension of the usual notion which also incorporates two less common ingredients: non-determinism and partiality, following\u00a0[4, 8]. These two ingredients play essential roles in our forthcoming results.\nA partial non-deterministic matrix (PNmatrix) is a pair  where  is a signature, and  is such that\n is a\nset (of truth-values),  is the set of designated values, and\nfor each  and ,  provides the truth-table  of\u00a0 in . When appropriate we shall refer to  as a -PNmatrix.\nWhen  for all  we say that the truth-table of  in\n is total. When  has at most one element for all  we say that the truth-table of  in\n is deterministic.\nWhen all the truth-tables are total, we say that  is also total, or equivalently that it is a non-deterministic matrix (Nmatrix).\nAnalogously, when all the truth-tables are deterministic, we say that  is also deterministic, or equivalently that it is a partial matrix (Pmatrix).\nFinally, if  is total and deterministic we say that it is simply a matrix (the usual notion of a logical matrix, up to an isomorphism).\nA -valuation is a function  such that  for every , every -place connective , and every . We denote the set of all -valuations by .\nAs is well known, if  is a matrix then every function  with  can be extended to a -valuation (in an essentially unique way for all formulas  with ). When  is a Nmatrix, a function  as above can possibly be extended in many different ways. Still, we know from\u00a0[4] that a function  with  can be extended to a -valuation provided that  and\nthat  whenever . We dub such a function a prevaluation of the PNmatrix .\nIn case  is not total, in general, one does not even have such a guarantee\u00a0[8], unless . In other words, given , we have  if the values in  are all together possible in some valuation of . Of course,  if .\nGiven a signature , a bivaluation is a function . The set of all such bivaluations is denoted by .\nA set of bivaluations  is known to characterize a multiple-conclusion relation  defined by\n when, for every , either  or . Of course,  also characterizes the more usual single conclusion relation\n such that  when , i.e., . In both cases,\n is a logic whenever  is closed for substitutions, that is, if  and  then . Easily, by definition, if  then .\nA PNmatrix  with  easily defines a set of induced bivaluations, closed for substitutions, namely , where  such that  if , and  if , simply captures the distinction between designated and undesignated values.\nWe will write  instead of , and say that  is the type-conclusion logic characterized by , for , which is always compact (finitary) when  is finite. Clearly, .\nNote that if  is a maximal consistent theory-pair of  then there must exist  such that , and consequently also . In the single-conclusion case, it is well-known that if  is a relatively maximal theory of  then there must also exist  such that  (see\u00a0[69]).\nWhen  and , it is straightforward to check that\n characterizes the extension to  of the logic characterized by .\nIt is worth noting that  is still closed for substitutions because  is a substitution, and ; consequently, we have that  and  is in  if  is.\nWhen  is a PNmatrix it is very easy, making essential use of non-determinism, to define a PNmatrix  that characterizes the extension to  of the logic characterized by . If , one defines  such that  if , and  for every  if  is a -place connective. It is straightforward to check that .\nOur work in the next Section of the paper is to prove results that enable us to describe the semantics of the combination of logics characterized by (P)(N)matrices, analogous to Proposition\u00a02. Before tackling these problems, it is certainly useful to ground all the relevant notions to concrete illustrative examples.\n2.5 Illustrations\nIn this subsection we present a few examples illustrating the relevant notions, as introduced earlier, including the new semantic phenomena brought by partiality and non-determinism, the divide between the single and multiple-conclusion settings, and also the idiosyncrasies of combined logics.\n(Classical logic, fragments and combinations).\nLet  be the usual connectives , that is, , ,\n, and  for .For simplicity, given some connectives  of the signature, we will write  to denote the subsignature of  containing only the connectives in .Take, for instance,  and\n. The formula  is such that its skeleton from the point of view of  is , if  and for the monolith we have . However, from the point of view of  we have that  is itself a variable, as  is a monolith.Consider now the Boolean -matrix\n\ndefined by the following tables. It is well-known that this matrix characterizes classical propositional logic, and we will write .\nHowever, we can also define a multiple-conclusion version of classical logic . Of course, we have that\n, but in this case\n. Namely, note that\n and , but one has .The multiple-conclusion version of classical logic  is known from\u00a0[69] to be alternatively characterized by the following multiple-conclusion calculus.It is crucial to observe that the axiomatization above is completely modular with respect to syntax, as each rule involves a single connective.\nSaid another way, the axiomatization is obtained by joining axiomatizations of each of its single-connective fragments, or equivalently\nwe have thatwhere  for each  is the corresponding single-connective fragment of the logic.\nThis fact marks a sharp contrast with respect to the single-conclusion setting, which goes well beyond classical logic, and that will play a key role in our developments. Namely, the single-conclusion version of classical logic is known to be characterized by the following single-conclusion calculus.The fact that the single-conclusion axiomatization is not at all modular with respect to syntax, and that most rules refer to more than one connective, is definitely not a coincidence, as shown in\u00a0[21]. Indeed, each of the single-connective fragments  of  for each connective  can be axiomatized as follows (see\u00a0[62]).It is clear that joining all these rules will yield a logic much weaker than classical logic (see\u00a0[21]), that is,A suitable semantics for the resulting combined logic is not obvious. \nThe previous example, though very familiar, was useful for illustrating some of the notions and notations used in this paper, and in particular the differences between the single and multiple-conclusion settings, namely when combining logics. However, even in a two-valued scenario, non-determinism allows for characterizing some interesting non-classical connectives and logics.\n(Some new two-valued connectives).\nConsider the signature  such that , ,\n, and  for , and the Boolean-like -Nmatrix\n\ndefined by the following tables.The first connective  is a completely free -place connective, known as botop in\u00a0[55]. Its logic is characterized by the empty calculus, without any rules. Then,  is a -place modal-like box operator whose logic is characterized by the usual necessitation rule:The -place implication-like connective  is characterized solely by the rule of modus ponens:All rules above serve both the single and multiple-conclusion settings.Lastly, the -place connective , was named platypus in\u00a0[50], and features some properties of classical conjunction mingled with classical disjunction. Namely, its multiple-conclusion logic is characterized by the following two (familiar) rules.As shown in\u00a0[50], the single-conclusion logic of platypus cannot be finitely axiomatized. \nOf course, the added richness provided by non-determinism goes well beyond the two-valued cases seen above.\n(Information sources).\nIn\u00a0[3], the authors introduce a logic for modelling the reasoning of a processor which collects information from different classical sources. Namely, each source may provide information that a certain formula of classical logic is true, or false, or no information at all. This situation gives rise to four possible situation as, for each formula,  the processor may have information that it is true and no information that it is false, or  information that it is false and no information that it is true, or  have information that it is true and also information that it is false, or  have no information at all about the formula. This situation is easily understandable if one reads the situations as collecting the available classical truth-values (0,1) for each formula asAs originally presented, the logic is defined over the signature  and characterized by the Nmatrix\n defined by the tables below.Clearly, both conjunction and disjunction have non-deterministic interpretations. For instance, note that . Thus, a valuation  may be such that there exist formulas  with  and .From\u00a0[54, 19] we know that both  and  are axiomatized by the following\nrules.The fact that this single-conclusion calculus characterizes the multiple-conclusion consequence  is remarkable, implying that\n.\nNamely, given any set of formulas , note that , as the function such that  for all formulas , is such that .Note that these logics could not possibly be characterized by finite matrices. Namely, let  be a variable, and define  and  for . Note that  satisfies , and consider for each  the prevaluation  of  defined byEach  thus extends to a valuation  showing that  for . Hence,  fails to be locally finite and therefore cannot be characterized by a finite set of finite matrices\u00a0[22]. The same applies to , simply because .\n \nBesides allowing for a great amount of compactification, non-determinism has another outstanding property regarding modularity with respect to syntax.\n(Language extensions).\nAbove, given a logic  and ,\nwe have defined its extension to the larger signature as\n. If  has an associated calculus , then it is clear that the extension  is associated to the exact same rules via the calculus .Take, for instance, single-conclusion classical propositional logic  as defined in Example\u00a03. Suppose that we wish to consider its extension to a larger signature  containing a new connective . We know that the exact same calculus presented above is associated to the extended logic\n. What is more, we also have that the extended logic is characterized by the -Nmatrix\n which extends the -matrix  by lettingwhere the connective is interpreted in a (neutral) fully non-deterministic manner.\nThis extension could not be possibly characterized finitely without using non-determinism\u00a0[4].\n \nAt last, we should illustrate the advantages and intricacies that result from introducing partiality.\n(Kleene\u2019s strong three-valued logic).\nWe consider the implication-free fragment of Kleene\u2019s strong three-valued logic as defined in\u00a0[36]. The logic is defined over the signature  and is usually characterized by means of two three-valued -matrices. Equivalently, the logic is given just by the four-valued Pmatrix  defined by the following truth-tables.Note that several entries of the tables contain , namely . As such, it is clear that a valuation in  cannot both use the values  and . As a consequence, we have that\n The two three-valued matrices mentioned above correspond to\nthe (total) restrictions of  to  and to .The single-conclusion logic  is known to be associated with the calculusThe multiple-conclusion logic  is known from\u00a0[19] to be associated with the calculusThis latter multiple-conclusion calculus is clearly more natural. As it contains genuinely multiple-conclusion rules, in this case,\n. Note, for instance, that , but that\n and . \nPartiality can indeed be used in almost all cases to provide a single PNmatrix for a logic characterized by a set of Nmatrices, as we will see later.\n3 Semantics for combined logics\nIn this section, we are seeking semantic characterizations for combined logics, using bivaluations, and then PNmatrices. The multiple-conclusion abstraction, which we will analyze first, is important for its purity with respect to combination. As we will show, the step toward the single-conclusion case is then a matter of controlling, semantically, the relationship with the multiple-conclusion companions.\nIn both cases, non-determinism and partiality play fundamental roles (as we know that similar results are impossible with respect to matrices).\n3.1 The multiple-conclusion case\nIn the multiple-conclusion case, the characterization we need is really very simple, if one considers bivaluations.\nThe result stems directly from the known fact (see\u00a0[69]) that for every multiple-conclusion logic  there exists a unique set of bivaluations  such that , namely . Note that this also implies that  if and only if .\nWe fix signatures , and sets of bivaluations  and , both closed for substitutions.\nWe have that\n with .\nLet , meaning that  is the least consequence with .As  it follows that  and . Since  is the least\nconsequence with this property we can conclude that , and therefore .Reciprocally, as  and  it follows that , and so .\u220eThis result allows us to obtain a clean abstract characterization of the combination of multiple-conclusion logics. One just needs to note that, given a signature , a partition  of  is essentially the same thing as a bivaluation  with  and .Let ,  be multiple-conclusion logics, and consider their combination . For every , we have:Using Proposition\u00a08, and letting  and , we have\n if and only if\nthere exists  such that  and  if and only if\nthere exists  such that  and  if and only if\nthere is a partition  of  such that  and .\n\u220eThe question is now whether we can mimic this simplicity at the level of PNmatrices.\nIt turns out that one can define a\nvery simple but powerful operation (already studied in\u00a0[53] with respect to Nmatrices, but only in the disjoint case) in order to combine PNmatrices.We fix PNmatrices  and , with  and .The strict product of  and  is the PNmatrix  such that  where,, andfor every ,  and , we define  by letting  if and only if the following conditions hold:if  then , andif  then .Note that  contains all pairs of truth-values which are compatible, that is, either both designated, or both undesignated. The pairs where both values are designated constitute . The truth-table of a shared connective  comprises all the pairs of values in the truth-tables of  which are compatible. The truth-table of a non-shared connective, say , has each possible value in the truth-table of  paired with all compatible values in . Clearly, the resulting PNmatrix is fundamentally non-deterministic for non-shared connectives whenever the given PNmatrices have several designated values, and several undesignated values. For shared connectives, non-determinism may appear if inherited from some of the given PNmatrices. Partiality, on its turn, is crucial to the interpretation of shared connectives, showing up whenever the values given by the truth-tables of  cannot be paired compatibly. For non-shared connectives, partiality may still appear if inherited from the given PNmatrices, or in pathological cases where the given PNmatrices do not have designated values, or do not have undesignated values.Before characterizing the exact scope of this construction, we should note that valuations in  are always suitable combinations of valuations in  and . For , we will use  to denote the obvious projection functions, i.e.,  and .\nEasily, if  then . Also, it is easy to see that , ,  are all compatible for every formula  in the combined language. Further, if , , and  is compatible with  for every , then  with  for each . These properties apply also to prevaluations over any set of formulas closed for subformulas..Pick . If  then . By definition of , it follows that\n and\n are compatible for every formula in , and thus induce the same bivaluation. We then have that .Reciprocally, given valuations  and  inducing the same bivaluation, it turns out that they must be compatible for all formulas,  if and only if . Therefore,  is compatible with both, as  if and only if , and induces the exact same bivaluation. We conclude that .\n\u220eNow, we can easily identify the multiple-conclusion logic characterized by a strict product as the corresponding combined logic.The combination of multiple-conclusion logics characterized by PNmatrices is the multiple-conclusion logic characterized by their strict product, that is,\n.The result follows directly from Proposition\u00a08 and Lemma\u00a011.With  and , just note that\n.\u220eThis result, besides being based on a simple operation on PNmatrices, has a very useful feature: it provides a finite-valued semantics for the combined logic whenever we are given finite-valued semantics for both given multiple-conclusion logics.Let us look at some examples, starting with the two-valued case.(Multiple-conclusion two-valued combinations).\nTake two signatures  and consider two-valued PNmatrices  with\n and , such as those in Examples\u00a03 or\u00a04.Note that according to Definition\u00a010,  is also two-valued, having values  and , with the latter designated. In the following discussion, for simplicity, we shall rename the two values to just 0 and 1, respectively, and assume that the strict product is .If  is a shared connective, and assuming for the sake of exposition that  is a -place connective, we have that  behaves as depicted below.\u2009\u2009This behaviour is absolutely similar for connectives with any number of places, that is,\n for any  and . Consequently,  whenever .If  is not a shared connective, and assuming without loss of generality that , , then in the strict product we have . This implies that one could simply consider the extended PNmatrices  and just use the equation above, as .It is clear that the resulting PNmatrix may be genuinely partial in case some of the sets are disjoint, and in general will be a Pmatrix whenever starting with two matrices.Recalling Example\u00a03, we see that given any two sets of classical connectives , if  and  are the\ncorresponding fragments of the classical matrix ,\nit follows that  is the fragment of  corresponding to\n. According to Theorem\u00a012, this implies that\n and thus we haveWe will see later that in the single-conclusion case the situation can be dramatically different. Let us now consider a richer example.(Combining the three-valued implications of Kleene and \u0141ukasiewicz).\nConsider the signature  with  and  for . The three-valued implications of Kleene and \u0141ukasiewicz are defined by the well known matrices  and\n defined below.According to Theorem\u00a012, we know that  is characterized by the five-valued -Pmatrix  given by the truth-table below, where for simplicity we have renamed each truth-value  to .Analyzing  it is clear that the values  and  are spurious, in the sense that they cannot be used by any valuation. This happens because the two corresponding diagonal entries of the table are empty, that is, .Removing these spurious elements we obtain the following table.Further, we also have that , which then implies that the total components of the Pmatrix are , which implies that  is precisely the set of all classical interpretations of classical implication. We can conclude, thus, that\n coincides with the multiple-conclusion implication-only fragment of classical logic, as defined in Example\u00a03.Confirmation of this interesting fact can be obtained by putting together calculi for the logics, according to Proposition\u00a02. These multiple-conclusion versions of the logics are not very well known, but a calculus for  can be readily obtained using the technique of\u00a0[54, 19], whereas a calculus for  can be found in\u00a0[2]. Of course, all the rules in these calculi are classically valid, because  (all classical valuations are permitted in both matrices). Further, as we know the rules of classical implication from Example\u00a03, it suffices to note that: (1) , and also ; (2) , and also ; and (3)\n and  which implies that .We will return to this example in the more familiar single-conclusion setting.\n We shall now illustrate how different it is to combine logics with or without shared connectives.(The three-valued implications of Kleene and \u0141ukasiewicz, disjointly).\nWe shall revisited Example\u00a014 above, combining the (multiple-conclusion) logics of Kleene\u2019s and \u0141ukasiewicz\u2019s three-valued implications, but now assuming that the connectives are syntactically different, i.e., that Kleene\u2019s implication comes from a signature  with  and  for , whereas \u0141ukasiewicz\u2019s implication comes from a disjoint signature  with  and  for . The corresponding matrices are now  with  and  with\n defined below.According to Theorem\u00a012, we know that  is characterized by the five-valued -Nmatrix  given by the truth-tables below.Of course, this is quite different from simply considering the given three-valued interpretations of each connective.\nNote, namely, that since all designated entries of  are also designated in  one could perhaps wrongly expect to have that . This assertion can be easily shown to fail by considering, for instance, any valuation  with  and , simply because\n is necessarily designated but  contains no designated value. \n3.2 The single-conclusion case\nThe results above really illustrate the simplifying power of using multiple conclusions. Of course, things are not so simple in the single-conclusion scenario. Still, we know enough to be able to take nice conclusions from the same line of reasoning. Let us start with bivaluations.\nIf we analyze the proof of Proposition\u00a08, it is simple to understand why it cannot be simply replicated in the single-conclusion case.\nEasily, the same line of reasoning would allows us to conclude that  with . However, in general,\n may very well not be the least such single-conclusion logic. Given  with , we cannot guarantee that .\nConcretely, assuming that  we still know that  and .\nThus, we still have bivaluations  such that  and , for . However, now, despite the fact that  and  coincide for all formulas in , we have no way of making sure that .\nThis problem lies in a crucial difference from the multiple-conclusion case, as the same single-conclusion logic can be characterized by distinct sets of bivaluations.\nGiven , let its meet-closure be the set\n with each meet defined by  precisely if  for every , for each . It is well known that\n if and only if , and thus that two sets of bivaluations characterize the same single-conclusion logic precisely when their meet-closures coincide. Namely, every single-conclusion logic  is such that  with , which is the largest set of bivaluations that characterizes .\nThe trick is then to work with meet-closed sets of bivaluations, that is, .\nIn that case, it is worth noting that .\nWe have that\n with .\nLet , meaning that  is the least consequence with .As  it follows that\n and . Since  is the least\nconsequence with this property we can conclude that , and therefore .Reciprocally, as  and  it follows that , and so .\u220eNote that  is necessarily meet-closed, as it is the intersection of meet-closed sets. Hence, not only  and , but also .The next abstract characterization of combined single-conclusion logics follows. Just note that given  closed for substitutions, it is always the case that  is a theory of . The converse is in general not true, unless  is meet-closed. Concretely, if\n is a theory of  then there always exists  such that .Let ,  be single-conclusion logics, and consider their combination . For every , we have:Using Proposition\u00a016, and letting  and , we have\n if and only if\nthere exists  such that  and  if and only if\nthere exists  such that  and  if and only if\nthere is  such that  is a theory of both\n and\n with .\n\u220eThis result captures neatly the intuition one already had from Proposition\u00a02, namely that  precisely when  is obtained by closing\n with respect to both  and .Turning to PNmatrices, expectedly, Theorem\u00a012 does not immediately apply to single-conclusion logics, as shown by the next counterexample.(Limitations of the strict product operation).\nWe present an example showing that, contrarily to the multiple-conclusion setting, the single-conclusion logic characterized by the strict product of two PNmatrices may fail to be the combination of the single-conclusion logics characterized by each of the given PNmatrices.Consider the -only and -only fragments of classical logic,  and  respectively, as defined in Example\u00a03. As we have seen in Example\u00a013, the strict product of their two-valued matrices is simply the classical two-valued matrix for both connectives  which characterizes the -fragment of classical logic.However, letting , and taking into account the single-conclusion calculi for each of the fragments, shown also in Example\u00a03 and also Proposition\u00a02, it is not at all clear that . As a matter of fact, this is not the case, as  is a strictly weaker consequence, as shown in\u00a0[21, 53]. Namely, . We will show exactly why in a forthcoming example.Clearly, the set of classical bivaluations for conjunction is meet-closed, and therefore the phenomenon above can only be justified by the fact that the set of classical bivaluations for negation is not meet-closed. Concretely, it is clear that there is a unique classical (bi)valuation  such that  for all , and thus  and so on, and also a unique classical (bi)valuation  such that  for all . Letting , it is immediate that  for , but it is also clear that  is not a classical bivaluation.\n As before, the problem lies with the fact that, in general, the set of bivaluations induced by a PNmatrix does not have to be meet-closed. In order to cope with this possibility, we consider the following property.A PNmatrix  with  is saturated if for each consistent theory  of  there exists  such that\n.If  with  is a saturated PNmatrix and  then it is worth noting that  is also saturated.\nIndeed, it suffices to observe, first, that  is a consistent theory of  if and only if  is a consistent theory of , and second, that if  for some valuation  then  with\n.Of course, a PNmatrix that has a meet-closed set of bivaluations is necessarily saturated.\nIt turns out, however, that saturation does not necessarily imply a meet-closed set of bivaluations, but it gets sufficiently close. Let  be the trivial bivaluation such that  for every . It is well known that  for . is saturated if and only if .Let  be saturated and . If  then . Otherwise,  is a theory of : if  is inconsistent then again ; if  is consistent then saturation implies that . We conclude that .\nTo conclude the proof note that , simply because , and any bivaluation  is such that  with .Conversely, assume that . If  is a consistent theory of  then, for each formula  there is a bivaluation  such that  and . Take . The meet bivaluation  and , which implies that  as  is consistent. We conclude that  and thus that  is saturated.\u220eUnder the assumption that the PNmatrices are saturated, Theorem\u00a012 can now be adapted to the single-conclusion case too.The combination of single-conclusion logics characterized by saturated PNmatrices is the single-conclusion logic characterized by their strict product, that is, if both\n and  are saturated then we have\n.The result follows directly from Proposition\u00a016, and Lemmas\u00a011\u00a0and\u00a020.With  and , note that we necessarily have\n.\u220eAs a corollary of this proof it also results that  is a saturated PNmatrix, and thus that saturation is preserved by the strict product operation.(Strict product and saturation).\nRecall the discussion in Example\u00a018 about the single-conclusion combination of the -only and -only fragments of classical logic,  and .Since the set of all classical bivaluations for the -only language is meet-closed, the classical -matrix  with , whose truth-table is shown below, is saturated.On the other hand, as seen before, the set of all classical bivaluations for the -only language is not meet-closed, and the corresponding two-valued matrix is not saturated. Instead, let us consider\nthe three-valued -matrix  as defined below.It turns out that . Further,  is saturated. To see this, given a consistent theory\n of , it suffices to consider the valuation  such thatBy the consistency of  we know that  is well defined, because  and  cannot both be in  due to rule\n. Additionally, rules  and  guarantee that  is indeed a valuation of .Given the saturation of the two matrices, according to Theorem\u00a021, the resulting combined logic  is characterized by the strict product . By Definition\u00a010 the resulting truth-values are  (where, again, we are simplifying each pair  to simply ). Renaming these values to simply , respectively, we have that  is defined by the truth-tables below.A valuation  such that ,  and  shows that\n.Of course, this implies that putting together calculi for each of the connectives is not enough to fully characterize the way they interact in classical logic, as can be visually confirmed from the rules in Example\u00a03.\n As this point, we should question the scope of applicability of Theorem\u00a021, and how often we can expect to find naturally saturated PNmatrices as in the example above. What should we do when given PNmatrices that are not saturated? Fortunately, there is a simple way of transforming a PNmatrix into a saturated PNmatrix both characterizing the same single-conclusion logic\u00a0333Note that the operation works precisely by weakening the associated multiple-conclusion logic, a subject to which we will return later on..Let  with  be a PNmatrix. The -power of  is the PNmatrix  with  such that,, andfor every ,  and , we let  if and only if the following condition holds:For each  we use  to denote the obvious projection function, i.e., . Clearly, we have that  if and only if  for every .If  is a PNmatrix then  is saturated, and further we have .We first show that .Suppose that , and let  be such that .\nFor every , this means that  and thus that .\nWe conclude that  and so .Suppose now that , and let  be such that .\nEasily,  defined by  for every  is such that , and .\nTherefore, we have that  and therefore, for any , .\nWe conclude that .To show that  is saturated, let  be a consistent theory of , and fix .\nFor each formula  we know that there exists a valuation  such that  and .\nFix an enumeration  and define, for each , the valuation  such thatLet  be such that  for every .\nWe have that  because  for every ,\nand for every , we have that  because with  we have .\nWe conclude that  is saturated444The proof of Lemma\u00a024 actually shows that the bivaluations of  are closed for non-empty denumerable meets. This is enough, in our case, since the empty meet corresponds to the irrelevant  bivaluation, and also because non-denumerable meets are not necessary given that we always work with denumerable languages..\u220eThe following result follows easily from Theorem\u00a021\u00a0and\u00a0Lemma\u00a024.The combination of single-conclusion logics characterized by PNmatrices is the multiple-conclusion logic characterized by the strict product of their -powers, that is,\n.Though still usable, this result does not provide us with a finite-valued semantics for the combined logic, even if departing from finite-valued PNmatrices. Indeed, in the relevant cases, a -power PNmatrix is always infinite (and not even denumerable), the exceptions being -powers of PNmatrices with at most one truth-value, easily seen to be saturated to begin with. Note also that the situation is not unexpected, as we know that some combinations cannot be endowed with finite-valued semantics\u00a0[52], and it is playing the role of meet-closure in the case of bivaluations. Still, there are cases when saturation is not necessary (we will see a relevant example of this phenomenon in Subsection\u00a05.1 below), or when saturation can be achieved by a finite power of the given PNmatrix. We present some examples below, and further discuss this question in the conclusion of the paper.(Three-valued implications of Kleene and \u0141ukasiewicz).\nRecall Example\u00a014, where we discussed the combination of the three-valued implications of Kleene and \u0141ukasiewicz in the multiple-conclusion setting, with shared implication, and we concluded that the resulting logic coincided with the multiple-conclusion version of the implication-fragment of classical logic.Now, we shall see that, incidentally, the corresponding single-conclusion combination also coincides with classical implication, albeit for distinct reasons.\nFor easier readability, we recall here the signature  with  and  for , and the three-valued implication matrices of Kleene and \u0141ukasiewicz, namely  and\n, defined below.Concerning the combined logic ,\nTheorem\u00a021 cannot be applied directly as the matrices are not saturated, which renders the strict product obtained in Example\u00a014 useless as our envisaged semantics for the combined logic.Concerning , let . The theory is consistent, as in particular we have\n (as can be confirmed by any valuation  with ) and also\n (as witnessed by any valuation  with  and ). Therefore,\n. However, there is no valuation  such that , simply because if  and  then by just inspecting the truth-table we conclude that  and .Concerning , consider . The theory is consistent, as in particular we have\n (as can be confirmed by any valuation  with ),\n (as witnessed by any valuation  with  and ), and also\n (as witnessed by any valuation  with  and ). Therefore,\n. However, there is no valuation  such that , simply because if  then by just inspecting the truth-table we conclude that ,  and .We must therefore consider the -power of each of the matrices. Note that in both cases, the resulting truth-values are infinite denumerable tuples  with each , which for simplicity we will represent as pairs of sets  with  and .\nOf course, then, . The resulting set of truth-values corresponds to\n. As both matrices have  as their unique designated value, we also get in both cases that . The resulting matrices are thus\n and\n, defined according to the tables below.According to Theorem\u00a025, we know that  is characterized by the infinite -Pmatrix . Representing pairs of pairs as four-tuples we get the set of truth-values\n, and designated values\n. The resulting strict product is then\n as defined by the table below.This semantics has a non-trivial look, but it turns out that one can still draw valuable conclusions from it. Due to the partiality of  it is worth noting that the Pmatrix has a lot of spurious values  useless for valuations, that is, values such that  . Note that, if defined, . Of course, this happens only when , or otherwise we have a spurious value.This observation implies that if  then  never uses the  value of matrix . As  behaves classically for the  values, we conclude that all bivaluations in  are classical. On the other hand, we know from Lemmas\u00a011, 20 and\u00a024 that , because obviously . Since not just  but also  behaves classically for the  values, we conclude that all classical bivaluations are in . Thus, we have that  is precisely the implication fragment of classical logic.Again, we can confirm this fact by putting together calculi for the logics, according to Proposition\u00a02. Even without listing the rules, and since it is well known that , it suffices to check that all rules of the calculus for  (see Example\u00a03) obtain when we join them. The rule of modus ponens is unproblematic, as we have both  and . Concerning the classical axioms , or actually any other classical tautology , note that , simply because a valuation  such that  must be classical, as .\nOn the side of \u0141ukasiewicz, it is clear that  for any formula . Hence, in the combined logic, we know that  for each , and also that  which implies that  for any classical tautology .\n One must, of course, look again at the combination of fragments of classical logic, now in the single-conclusion setting.(Combining fragments of classical logic).\nRecall Example\u00a03, as well as the multiple-conclusion scenario that we have explored in Example\u00a013. We will now see how much challenging and interesting it is to combine fragments of classical logic in the single-conclusion setting, by means of four distinct cases.(1)\u00a0Let us first consider the combination of the fragments of classical logic corresponding to  and . It is easy to see that the corresponding two-valued classical matrices are both saturated. Hence, the combined logic  is directly characterized by the corresponding strict product, which coincides with the\ntwo-valued classical matrix for the fragment . We conclude thus, that , which is compatible with our knowledge that joining single-conclusion calculi for  and  yields a calculus for .(2)\u00a0Now, let us reanalyze the combination of  and . We already know from Examples\u00a018 and\u00a022 that the combination  is weaker than . However, since the two-valued classical matrix for negation is not saturated, we have instead considered an adequate three-valued saturated matrix. Of course, we did not need to know that such a matrix existed, and instead we could have blindly obtained the -power of the two-valued classical matrix for negation, and then obtained its strict product with the saturated two-valued classical matrix for negation. The semantics thus obtained would be less amiable, but still characterizes the combination. Alternatively, we could have noted that the four-valued -power of the matrix of negation would already be saturated (the three-valued matrix used before is a simplification of it).(3)\u00a0As a last interesting example of disjoint combination let us consider the fragments  and . We already know from\u00a0[21] that the combination  is weaker than . Namely, we have that , as can be confirmed by any valuation with\n and , which then implies that , on the Nmatrix resulting from the strict product of the two-valued classical matrix for conjunction and the -power of the two-valued classical matrix for disjunction, corresponding (after renaming) to  as defined by the tables below.Of course a simpler semantics would be desirable, but we know that the two-valued classical matrix for disjunction is not saturated. Namely, note that  and  but any valuation  of the two-valued matrix that sets  necessarily must have  or .(4)\u00a0Finally, we shall look at a non-disjoint example, the combination of the fragments corresponding to  and . It seems clear, from the calculus for  shown in Example\u00a03, that all rules involving negation or disjunction only additionally use the shared connective of implication. We may therefore conjecture that\n. To confirm this, we first note that none of the two-valued classical matrices for the fragments is saturated. This is simply because both include implication,  and\n but any classical valuation will have  or . Thus, we need to consider the strict product of the -power of each of the matrices, which results (after renaming) in the PNmatrix\n as defined by the tables below, where we use .All classical bivaluations can be simply obtained in  by taking only the two values  and .\nSeeing that all valuations of  are classical (i.e., they respect the operations in ) is slightly harder. Let .Easily, we have  and hence  for some . Consequently, for any formula , if  then  and thus , which implies , or equivalently .\nFurther,  for some  such that . We can see that , which means that  and thus that . Also, we can see that , which means that  and thus that . From these observations, we conclude that .Let  be any surjective function. We claim that the function defined by  is a valuation over  (on the relevant connectives), which is compatible with , as whenever  we have  if and only if . Namely, it is straightforward to check that  and , and also easy to see that  using the observations in the previous paragraph.\n \n4 Universal properties\nAccording to the very successful mathematical approach to General Systems Theory initiated by J. Goguen in\u00a0[44, 45], composition operations should always be explained by universal properties, in the sense of category theory\u00a0[49, 1]. This approach has been used also with respect to combinations of logics, for instance in\u00a0[18, 65]. Herein, we briefly show how our results are explained by simple universal constructions.\n4.1 PNmatrices and rexpansions\nIn order to explore the relationships among PNmatrices, let us consider a suitable notion of homomorphism. If ,  and  are PNmatrices, with  and , a strict homomorphism  is a function  such that , and for every , , and , .\nEasily, if  then . Further, the strictness condition  implies that  and  are compatible for every formula . Consequently, we have that\n, and therefore  both in the single and the multiple-conclusion cases. PNmatrices with strict homomorphisms constitute a category\u00a0.\nExpectedly, the strict product of PNmatrices as introduced in Definition\u00a010 enjoys a universal characterization, whose proof is straightforward.\nLet  and  be PNmatrices.\nTheir strict product  is a product in , with projection homomorphisms\n for each .\nIt goes without saying that the relationships between valuations in the PNmatrices  and valuations in  mediated by the projection homomorphisms that were presented in Section\u00a03.1 are simple consequences of the universal property enjoyed by products in a category.\nA dual construction is also possible. The key idea is that one can take crucial advantage of partiality to blend together PNmatrices. Let  be a set of PNmatrices, each .\nThe sum of  is the PNmatrix  where\n is defined by ,\n, and\nfor  and ,\n.\nIt is clear that  is a coproduct of  in\u00a0,\nwith inclusion homomorphisms  defined, for each  and each , by . Therefore, we have . Perhaps surprisingly, however, it may happen that\n.\n(A badly-behaved sum).\nLet  be the signature whose only connectives are  and , and consider the matrices  with  and , and  with  and .Easily, we have that  with  such that  for every formula . We also have that .However, it is clear that  contains bivaluations which are neither in  nor in . For instance, given a variable , it is clear that\n such that  if  occurs in A, and  otherwise, defines a valuation . Hence,  contains the bivaluation  such that  if and only if  does not occur in , which is clearly not in . \n4.1.1 The good, the bad, and the ugly\nNow, we will prove the (good, very good) fact that \u2018almost\u2019 every logic (in the single or multiple-conclusion sense, it does not matter) can be characterized by a single PNmatrix (actually, a Pmatrix). This property is striking, as it is well known to fail for matrices, or even Nmatrices (see\u00a0[22, 69, 73]), and at the same time reinforces the wide range of applicability of our results. The bad and the ugly are actually both related to the \u2018almost\u2019 part of our statement. On the one hand, we need to understand the reason for the exception, which actually lies on the (bad) fact that valuations on PNmatrices cannot be locally assessed for a sublanguage (or subsignature). On the other hand, the nature of the exception is related to a rather annoying (and mathematically ugly) syntactic property. Both are suitably illustrated by Example\u00a029, as the the crucial reason for the behaviour shown in this example is the absence of a 2-place connective (actually, of any connective with at least two places).\nLet  be a set of PNmatrices. If  for some \nthen .\nObserve that if  and  are such that  and  then it must be the case that . This is a consequence of the existence of a connective  for some , as  and, by definition, we have  if .Hence, it is clear that if  then letting  if  defines a valuation . As the compatibility of these values is granted by the definition of designated values in , it easily follows that .\u220eWe can now take advantage of well-known results about logical matrices.\nRecall that a Lindenbaum matrix over  is a matrix of the form  for some , with  for every , , and . Given a bivaluation , we will use  as a synonym for the Lindenbaum matrix\n.In the single-conclusion case, we know that a logic  is precisely characterized by the set of its theories\u00a0[73]. Hence, the Lindenbaum bundle  consists of the Lindenbaum matrices  over  such that  is a theory of  (when the logic is compact, we could as well consider only its relatively maximal theories).In the multiple-conclusion case, a logic  is known to be precisely characterized by its maximal theory-pairs\u00a0[69, 31, 77]. Thus, the Lindenbaum bundle  contains precisely the Lindenbaum matrices  over  such that  is a maximal theory-pair of  (see\u00a0[16]).Given a set of bivaluation  closed for substitutions, we also define  as consisting of the Lindenbaum matrices  for every .The following result is an immediate consequence of Lemma\u00a030, taking into account the Pmatrix corresponding to summing the Lindenbaum bundle into consideration.Let  be a logic.If  for some  then\n.We should note that when considering signatures with no connectives with two or more places, it really may happen that the logic characterized by a set of PNmatrices does not coincide with the logic characterized by their coproduct.(A badly-behaved sum, continued).\nRecall Example\u00a029, with a signature  whose only connectives are  and , and matrices  with  such that , and  with  such that . Let . Recall also that  contains the bivaluation  such that  if and only if  does not occur in , which is clearly not in .It is not hard to see that given any PNmatrix  with  such that  it must also be the case that . Namely, since we have , there exist valuations  such that  and  for every . Therefore, the valuation such thatcan be easily seen to be also in . Just note that , and that , because both  and  are in  and  occurs in  if and only if  occurs in . We conclude that .It turns out that it is impossible for a PNmatrix to have , and thus necessarily  for every PNmatrix .Moreover, it is easy to see that  is meet-closed, and that if  is such that  is closed for substitutions and  then one must have . Thus, it is impossible for a PNmatrix to have , and one can also conclude that  for every PNmatrix .For the sake of closure, we should note that  and  where  contains the two ruleswhich are both single-conclusioned rules simply because  is meet-closed. Indeed, we have that  if and only if  for some , and additionally  if and only if  and , i.e.,  is not a variable.\n \n4.2 Multiple-conclusion combination\nThe results of Section\u00a03, namely Proposition\u00a08, Lemma\u00a011 and Theorem\u00a012, allowed us to characterize the combination of the multiple-conclusion logics defined by two PNmatrices as the logic defined by the intersection of their induced bivaluations, or equivalently as the logic of their strict product. Our aim is to provide a categorial explanation for these results.\n\nQBValMult\n\nIn the terminology of\u00a0[6], that we extend here to PNmatrices,\nthe existence of a strict homomorphism  means that  is a rexpansion of . For simplicity, we will consider the quotient of\n obtained by identifying all strict homomorphisms between the same two PNmatrices, thus obtaining a thin category that we will dub . Equivalently,  consists of the preordered class of all PNmatrices under the rexpansion relation, and we write  precisely when  is a rexpansion of . The obvious quotient functor  that sends each PNmatrix to itself is trivially continuous and cocontinuous. Therefore,\nit follows that  is a (non-unique) join in ,\nand we can say that  is the least PNMatrix of which all PNmatrices in  are rexpansions.\nDually,  is a (non-unique) meet in , and we can say that the strict product of two PNmatrices is the largest PNmatrix that is a rexpansion of both  and .\nWe need also to consider the posetal category , consisting of all pairs  where  is a signature and  is closed for substitutions, partially ordered by the relation defined as  if  and . Easily, the mapping BVal extends easily to a (order-preserving) functor  such that . If we further define  by  we also obtain a (order-preserving) functor, which is actually left-adjoint to BVal.\nThe functors  constitute a Galois connection, that is, for every  in  and every  in , the following conditions are equivalent:,.\nFirst assume that , i.e., there exists a strict homomorphism . Obviously,\nwe have . Given , we have the inclusion homomorphism . Composing, we have  and therefore . We conclude that\n, and so\n.Reciprocally, assume that . This means that not only\n but also . The latter inclusion implies that for each  there exists  such that , and thus  is a strict homomorphism. The universal property of  then implies that there exists an homomorphism  (actually a unique one with the property that  for every ). We conclude that .\u220eConsequently, BVal preserves meets (limits) and we rediscover Lemma\u00a011, as then\n, which is easily seen to be equal to .Finally, we consider another posetal category , of multiple-conclusion logics ordered by inclusion, that is,  if  and . It is clear that a combined logic  is a join  in . The mapping  such that  is now easily seen to establish an order isomorphism between . and . is a dual order isomorphism, that is:Mult is bijective, and if and only if .Mult is bijective precisely because for every multiple-conclusion logic  there exists one unique set  such that . We know from\u00a0[69] that , which relates to the set of all maximal theory-pairs of the logic.As a consequence, just note that  is equivalent to having that, for every ,  implies . On its turn, the later is equivalent to having, for every , that , which actually means that for every  there exists  such that , or simply that .\u220eAs a consequence, we can recover Proposition\u00a08, because   which, by duality, is equal to .Theorem\u00a012 can also be recovered, simply, by noting that  , which is equal to\n .\n4.3 Single-conclusion combination\nThe results of Section\u00a03, namely Proposition\u00a016 and\nTheorems\u00a021 and\u00a025, allowed us to characterize the combination of the single-conclusion logics defined by two PNmatrices as the logic defined by the intersection of the meet-closure of their induced bivaluations, or equivalently as the logic of the strict product of their -powers (or the PNmatrices themselves, when saturated). In order to explain these results categorially, we can adopt a similar strategy.\n\nQSing\n\nGiven the properties of -powers, as stated in Lemma\u00a024, we can restrict our attention to the full subcategory  of  whose objects are just the saturated PNmatrices. We apply the same restriction to obtain the full subcategory  of . As we know that the strict product of saturated PNmatrices is still saturated, the operation will still correspond to a (non-unique) meet in . Interestingly, however, coproducts of saturated matrices need not be saturated.\n(Sums and saturation).\nLet  be the signature whose only connectives are  and , and consider the PNmatrix  with  such that , , , and the matrix  with  such that .Easily, we have that , and\n. Since  we can conclude from Lemma\u00a020 that both PNmatrices are saturated.However, the PNmatrix  is not saturated. In fact, it suffices to show that\n, which clearly contains the bivaluation , is not meet-closed.\nTo see this, fix a variable  and note that  such thatare valuations . Hence,  such that  if and only if  with  even, and  if and only if  with  odd, both are bivaluations . Letting  we have  such that  if and only if  occurs in . It is not difficult to conclude that , noting that  is the only value not designated and that\nany valuation  such that\n must have .\n \nFollowing the lines developed in Section\u00a03, we shall also consider\nthe full subcategory  of  whose objects are meet-closed sets of bivaluations.\nThe functor  is such that . The functor \nis defined by\n. The following result shows that, despite of Example\u00a035, it is well-defined.\nIf  is a signature and  is closed for substitutions and meet-closed then  is saturated.\nFor simplicity, let .The result is immediate if  contains a connective with two or more places. When that is the case, Lemma\u00a030 guarantees that . As one can easily check, for Lindenbaum matrices,\n is simply  closed for substitutions,\nand thus  since  is itself closed for substitutions. Therefore, we have that , and by Lemma\u00a020, since  is meet-closed, we can conclude that  is saturated.Things are less straightforward when  for every , since we know that the set  may include bivaluations not in . Indeed,\nletting\n be the unique atomic subformula of , one has  if and only if there exists a function  such that  for every formula . For simplicity, we use  instead of just  to denote each such substitution\n555To make it more explicit, this means that each valuation  can be made to correspond with\nchoosing a bivaluation  for each , and setting \n(which is designated precisely when ) for each formula .\nA similar characterization would apply, mutatis mutandis, to arbitrary coproducts of (total) Nmatrices over a signature without connectives with two or more places..To establish that  is saturated, using again Lemma\u00a020, it is sufficient to show that given  if the meet  then . First note that if  then it is the case that , and we can fix . For each  consider . As  is meet-closed, the meet , but it may still happen that . Define  byWe claim that . To see this, consider a formula  and let .If  then  if and only if  for every  if and only if .If, on the contrary, we have  this means that  for every . Therefore, it follows that , since  for every .\u220eSimilarly, we have that  is left-adjoint to .The functors  constitute a Galois connection, that is, for every  in  and every  in , the following conditions are equivalent:,.Let  be a meet-closed set of bivaluations closed for substitutions, and\n be a saturated PNmatrix.\nThe result follows from Proposition\u00a033. Indeed,  if and only if\n in , which is equivalent to having  in .\u220eConsequently,  preserves meets (limits). Note also that, in the category , we have that .Finally, we consider another posetal category , of single-conclusion logics ordered by inclusion, that is,  if  and . It is clear that a combined logic  is a join  in . The mapping  such that  is again an order isomorphism, now between  and . is a dual order isomorphism, that is:Sing is bijective, and if and only if .Sing is bijective precisely because for every single-conclusion logic  there exists one unique meet-closed set of bivaluations  such that . We know from\u00a0[73] that .As a consequence, just note that \nif and only if , just because  is meet-closed and thus, equivalently,\n.\u220eAs a consequence, we can recover Proposition\u00a016 too, just because we have which, by duality, equals \n .Theorem\u00a021 can also be recovered. If  and  are saturated PNmatrices, then note that  , which equals\n . Theorem\u00a025 also follows, by the same argument, using Lemma\u00a024.\n5 Examples and applications\nBesides illustrating examples, of which we have already shown a few, our aim is now to present concrete applications of the tools we defined for obtaining usable semantics for combined logics, namely with respect to the modular conception and analysis of logics.\n5.1 Adding axioms\nOften, one works with a single-conclusion logic which can then be streghtened by the addition of new axioms\u00a0[6, 26, 20] (and possibly also new syntax). Concretely, let  be a single-conclusion logic,  be a signature,  be a set of axiom schemata, and define . The strengthening of  with the schema axioms  is the single-conclusion logic \ndefined by  if and only if , for every .\nOur aim is to apply the ideas developed above in order to obtain a semantic characterization of  from a given semantic characterization of .\nIn terms of bivaluations, the following simple result from\u00a0[21] is instrumental.\nLet  be signatures,  closed for substitutions, and .\nThe single-conclusion logic  is characterized by .\nGiven , note that  if and only if there exists  such that  and  if and only if there exists  such that\n and  if and only if\n if and only if .\n\u220eClearly, . Of course,\n is easily seen to be meet-closed, but such a requirement is clearly not necessary for .With respect to PNmatrices, we can take advantage of non-determinism for building a simple semantics for the logic associated to the calculus whose rules are precisely  for each , also equivalently defined by the set of bivaluations .The Nmatrix  with  is defined by,, andfor every ,  and , we letIt is easy to characterize the properties of this construction.We have that .Easily, if  and  then necessarily . Therefore, we have .If  is such that , then we can easily build a compatible valuation  by letting\n for each . We conclude that .\u220eOf course, it is simple to check that  if and only if , and thus that\n. It is worth noting too that  is saturated.The strengthening with  of the single-conclusion logic characterized by a PNmatrix is the single-conclusion logic characterized by its strict product with , that is,\ngiven a PNmatrix , we have that\n.The result follows directly from Proposition\u00a039, and Lemma\u00a011\u00a0and\u00a041.With , note that we necessarily have\n.\u220eNote that this construction, though similar to the ones presented in the previous section, has a remarkable difference: the PNmatrix  does not need to be saturated.\nThe proof technique is essentially the same, but takes advantage of the fact that any set extending a theory of  is still a theory, as it retains all the instances of axioms. The end result, though, is still infinite-valued (denumerably infinite, now, provided  is denumerable), but has really interesting consequences.For instance, we have seen in Example\u00a04 that the logics defined by the rules of modus ponens and/or necessitation,can be given a very simple non-deterministic two-valued semantics. Hence, according to Theorem\u00a042, every logic obtained from these by the addition of axioms can be characterized by a denumerable PNmatrix, which of course includes every modal logic, normal or not. A most interesting consequence of this idea is shown in the following example.(Intuitionistic logic).\nFix a signature  containing the desired set of intuitionistic propositional connectives, including implication, i.e., . Also, fix a set of axioms  which together with the rule of modus ponens constitutes a calculus for intuitionistic propositional logic  ( could consist of just the first two axioms in the axiomatization of , in case implication is the only connective of ).Take a signature  whose only connective is implication, that is,  and consider the -Nmatrix  where  as defined in Example\u00a04. That is to say that  is the logic axiomatized by the rule of modus ponens.Obviously, , and Theorem\u00a042 tells us that it is characterized by the PNmatrix .\nSince  is finite and  is denumerable, we can conclude that  is denumerable, which means that intuitionistic propositional logic\ncan be characterized by a single denumerable PNmatrix. This is a remarkable property of PNmatrices, witnessing their compactification abilities, as it contrasts with the known fact that a characteristic matrix for intuitionistic logic needs to be non-denumerable\u00a0[43, 75, 73].  Nicer, finite-valued, semantics can be obtained in particularly well-behaved scenarios, which (unsurprisingly) do not include the examples above. We refer to reader to\u00a0[20] for further details.\n5.2 Axiomatizability by splitting\nObtaining symbolic calculi, or axiomatizations, for logics of interest, namely if presented by semantic means, is well-known to be a non-trivial task, even harder when one seeks particularly well-behaved calculi. Herein, we show that to some extent, our results about combined semantics can have an impact on the possibility of splitting this task into the problem of obtaining calculi for suitably defined syntactic fragments of the logic, which can then put together, in a modular way, to produce a calculus for the original logic. Indeed, in abstract, given a logic  we will be looking for ways to obtain logics  such that .\nConcretely, let  with  be a PNmatrix, and split the associated logical language into signatures  such that .\nFor , consider the component PNmatrix  where  is the reduct of  to the subsignature , that is  for every connective . Under which conditions can we obtain an axiomatization of  by just putting together axiomatizations of  and , in either the single and multiple-conclusion settings?\nIt is useful to introduce the following notation. Given , a formula  with , and values , we define . Given formulas  we will also use  to denote the formula  where  is a substitution such that .\nRecall from\u00a0[69, 54, 19] that  is said to be monadic provided that\nfor every two values  with  there exists a one-variable formula , to which we call a separator of  and , such that  and  and , or vice-versa. When all the separators  can be found in  for a subsignature , we say that the PNmatrix is -monadic.\nIf  is -monadic then .\nTaking advantage of rexpansions, and the universal property of strict products from Proposition\u00a028, it is clear that there are two identity strict homomorphisms  and , and thus there exists a strict homomorphism  (namely,  and  for every ). Therefore, we know .To prove the converse inclusion, we need to take into account that  may have spurious values, that is, pairs  such that  for whatever  and . Indeed, we can show that if  then it must be the case that , using the proviso of monadicity on the shared subsignature. Indeed, if  then there exists a separator  of  and . Easily, then,  which is impossible because the strict product does not have pairs of values where one is designated but not the other. Hence, it is easy to see that  such that  if , for each formula , defines a compatible valuation . We conclude that .\u220eWe can now state our split axiomatization result for multiple-conclusion logics.If  is an axiomatization of , for each , then  is an axiomatization of ,\nprovided that  is -monadic.Clearly, using Theorem\u00a012 along with Proposition\u00a02, we have\n, that is,  is an axiomatization of the multiple-conclusion logic characterized by the strict product . Using the monadicity proviso, Lemma\u00a044 ensures that  and therefore , which concludes the proof.\u220eThe previous result allows us to obtain a multiple-conclusion calculus for the logic characterized by a given PNmatrix by simply putting together calculi for simpler logics, under the appropriate provisos. For instance, taking advantage of techniques such as\u00a0[54], one can even obtain incrementally analytic axiomatizations for the logic of a given monadic PNmatrix.It is worth noting that the result of Theorem\u00a045 has some simple immediate consequences. Namely, it trivially applies to any PNmatrix having no more than one designated value and one undesignated value, namely in Boolean like PNmatrices like those in Examples\u00a03 and\u00a04, by simply using the separator  (this actually shows that one can provide axiomatizations for each connective separately, not just for fragments of classical logic, but also covering less common two-valued non-deterministic connectives). Let us look at another interesting example.(Kleene\u2019s strong three-valued logic, revisited).\nRecall the multiple-conclusion version of the implication-free fragment of Kleene\u2019s strong three-valued logic  from Example\u00a07, defined on the signature  containing the connectives . The characteristic four-valued -Pmatrix  is easily monadic, using  as its separators. Namely,  separates the designated values  from the undesignated values , and  separates  from , and also  from .Consider the splitting corresponding to the signatures  with  containing  and  containing , and let  and  be the corresponding reducts of .\nSince , Theorem\u00a045 tells us that we can obtain a calculus for  by simply joining calculi for the fragments  and .It is worth noting that in the multiple-conclusion calculus for  put forth in Example\u00a07, the rules where  does not appear constitute a calculus for , and the rules where  does not appear constitute a calculus for .\n In the following example we will see that monadicity in the shared language is only a sufficient condition for splitting axiomatizations, but that it really plays an important role in the result.(Three-valued \u0141ukasiewicz logic).\nExpanding from Example\u00a014, let us now consider the signature  with ,  and  for . The three-valued matrix of \u0141ukasiewicz for these connectives is  as defined below.Besides the familiar connectives of negation and implication, \nis a possibility operator that can be traced back to \u0141ukasiewicz and Tarski (see [72]).\n\nNote that  is definable as , and thus .The matrix  is monadic, namely using  as its separators, but also alternatively using\n, as both  and  separate  from . However, one cannot separate these values using only implication. This said, we could of course apply Theorem\u00a045 to splittings of signatures sharing , or , or both, as in the previous example. Instead, let us look at some more informative cases.(1) Let us first consider the splitting corresponding to the signatures  with  containing  and  containing , and let  and  be the corresponding reducts of .\nSince , Theorem\u00a045 cannot guarantee that we can obtain a calculus for  by simply joining calculi for the fragments  and . Indeed, this can never be the case as  is strictly weaker that the \u0141ukasiewicz logic . To see this, note that the strict product\n is defined by the tables belowand that , as witnessed by a valuation  with , , which necessarily has .This example shows that although the given PNmatrix, in this case , is both -monadic and -monadic, the splitting may behave badly precisely because  is not -monadic.(2) Let us now consider the splitting corresponding to the signatures  with  containing  and  containing , and let  and  be the corresponding reducts of .\nAgain, since , Theorem\u00a045 cannot guarantee that we can obtain a calculus for  by joining calculi for the fragments  and . However, in this particular case, it turns out that one can safely join split axiomatizations, simply because\n. To see this, note that the strict product\n is\nsimilar to the one above, but with implication interpreted now as in the table below.Clearly, all bivaluations in  are also in , namely if one considers the total component  whose tables, depicted below, are simply a renaming of the truth-tables of .This example shows that the requirement that the given PNmatrix is -monadic is sufficient, but not necessary, for the splitting axiomatization result to follow.\n Although obtaining axiomatizations for single-conclusion logics is known to be substantially harder, our line of reasoning may still apply, as long as we further demand saturation.If  is an axiomatization of , for each , then  is an axiomatization of ,\nprovided that  is -monadic and saturated.It is easy to see that if  is saturated, then  is also saturated, for . If  is a consistent theory of  then  is a consistent theory of . From the fact that  is saturated it follows that there exists  such that . If we set  such that  for every  it is clear that\n. Further,  because, for ,  if and only if  if and only if  if and only if .Using Theorem\u00a021 and Proposition\u00a02, we can conclude that\n, that is,  is an axiomatization of the single-conclusion logic characterized by the strict product . Using the monadicity proviso, now, Lemma\u00a044 ensures that  and therefore , which concludes the proof.\u220eNote that the saturation proviso makes the result of Theorem\u00a048 harder to use. In any case, the result is in line with the results of\u00a0[21], namely about the (im)possibility of independently axiomatizating each Boolean connective in fragments of classical logic.(Classical logic can hardly be split).\nRecall Example\u00a03, and the analysis of combined fragments of classical logic in the single-conclusion setting that we developed in Example\u00a027. Much as these combinations differ substantially from the multiple-conclusion case, also splitting axiomatizations of classical logic, universally possible in the multiple-conclusion scenario, as we saw above, become a rarity in the single-conclusion case.We have seen that classical matrices are always trivially monadic, but now Theorem\u00a048 further demands saturation. It turns out that the two-valued interpretation of most interesting classical connectives is not saturated, namely for fragments containing , , or , as we have seen previously, which leads mostly to the failure of split axiomatizations as already shown in Example\u00a027.Connectives whose interpretation is saturated include, however, , , and . Hence, Theorem\u00a048 tells us that fragments of classical logic corresponding to signatures  can be axiomatized by putting together axiomatizations for each of the connectives. Namely, as seen in Example\u00a027, joining single-conclusion calculi for  and  yields a calculus for .\n We next analyze another interesting example.(Axiomatizing information sources).\nRecall from Example\u00a06 the logic of information sources defined over the signature  containing the connectives  by the characteristic four-valued -Nmatrix\n. It is easy to see that  is -monadic, with separators .According to Theorem\u00a045, the observations above imply that a multiple-conclusion calculus for  can be obtained by joining multiple-conclusion calculi for fragments based on splitting signatures  such that  as long as .Further, the Nmatrix  is saturated. Given a consistent theory  of , it is easy to see that  where  is defined as follows.Actually, the saturation of  can also be seen as a consequence of the fact that  is axiomatized by a single-conclusion calculus.Hence, according to Theorem\u00a048, we know also that a single-conclusion calculus for  can be obtained by joining single-conclusion calculi for fragments based on splitting signatures  such that  as long as . This is apparent in the calculus put forth in Example\u00a06, if we consider  and .\n \n5.3 Decidability preservation\nTransference theorems have always been a main drive of the research in combining logics. Decidability is certainly one of the most desirable properties a logic should have, opening the way for the development of tool support for logical reasoning. There are some known results\u00a0[30, 51], namely with respect to disjoint combinations, but it is worth looking carefully at the semantic characterizations developed in the previous section, and analyzing their contribution to decidability preservation in general. That is, when given two decidable logics, under which conditions can we guarantee that their combination is still decidable?\n5.3.1 Deciding multiple-conclusion combined logics\nLet us first look at the decision problem for multiple-conclusion logics. We will say that a multiple-conclusion logic  is decidable if there exists an algorithm , which terminates when given any finite sets  as input, and outputs  if , and  if . According to this definition it is clear that one is actually deciding the compact version  of the logic, and hence we will henceforth assume, without loss of generality, that the logic at hand is compact.\nOf course, any logic characterized by a finite PNmatrix is decidable\u00a0[8]. This case covers the combination of any two logics when they are each characterized by a finite PNmatrix, given that the strict product operation preserves finiteness. But we can go beyond the finite-valued case.\nCorollary\u00a09 is quite appealing, and mathematically clean, but a decision procedure based on it would require (potentially) running through all partitions of the set of all formulas. As the similarity with cut for sets is striking, one may try to obtain a more usable version inspired by cut for a suitable finite set, namely in relation to the input, which we will dub context.\nIn general, we demand a context function  such that . Aiming at decidability preservation, of course, we will further require that  is finite for finite .\nLet  and  be sets of bivaluations closed for substitutions.\nWe say that  are -extensible when, for any finite set\n,\nif there exist  and  such that  for every , then there must exist  such that  for every .\nWe say that multiple-conclusion logics ,  are -extensible when  and  are the (unique) sets of bivaluations characterizing them, that is,  and , and  are themselves -extensible.\nThis definition has a more abstract alternative characterization.\nLet ,  be multiple-conclusion logics,  their combination, and  a context function. The following are equivalent:,  are -extensible;given any partition  of  for finite , if\n and  then\n.\nThe result is immediate, taking into account Proposition\u00a08 and the fact that, for each , the unique set of bivaluations characterizing\n is .\u220eWe can now obtain a more decidability-friendly version of Corollary\u00a09.Let ,  be -extensible multiple-conclusion logics, and consider their combination . For every finite , we have:Using Corollary\u00a09, if  then there exists a partition  of\n such that  and\n.\nIt is easy to see that  is a partition of , and by dilution,\n and\n.Reciprocally, if there is a partition  of  such that  and  then, directly from -extensibility and Lemma\u00a051, we can conclude that , or equivalently, since monotonicity implies that  and , that .\u220eWe now apply these ideas toward decidability preservation we assume that the context function  is computable.Let  be -extensible logics.\nIf  is computable and  are both decidable then their combination\n is also decidable.Let  be algorithms deciding , respectively.\nTo decide  consider the following non-deterministic algorithm .The correctness of  is an immediate consequence of Lemma\u00a052, noting that the no output is always correct, independently of the non-deterministic choice of the partition, whereas the yes output is only correct when it holds for all choices.\n\u220eLet  be PNmatrices with a total strict product .\nIf  are both decidable then their combination  is also decidable.Given Theorem\u00a053, it is enough to observe that  are -extensible whenever  is total. Note also that  is computable.Just note that given a set  and valuations  such that  is compatible with  for every , the function  defined by  is a prevaluation of . Therefore, as  is total,  extends to a valuation . Lemma\u00a011 thus guarantees the envisaged -extensibility property.\u220eIt should be noted that -extensibility, or totality of the strict product in the case of PNmatrices, is a sufficient condition for preserving decidability, but further research needs to be done in order to find tighter conditions.(Decidability preservation for disjoint combinations).\nA major result of\u00a0[51] was the preservation of decidability for disjoint combinations of single-conclusion logics. We will get back to this particular result in the next subsection, but for now we will show that decidability is preserved also by disjoint combination of multiple-conclusion logics. Assume that both  are decidable, and .As a first, partial, approach, let us consider the case when one knows that there exist (total) Nmatrices  such that  and . If each of the Nmatrices has both designated and undesignated values, it follows easily from Definition\u00a010 that  is also a (total) Nmatrix, and the combined logic  is decidable as a consequence of Corollary\u00a054.Of course, if any of the two Nmatrices only has all its values designated (or all undesignated), the corresponding component logic will be trivially decidable, and the same applies to the resulting combined logic. However, in general, there is no reason to assume that the given logics can be characterized by (total) Nmatrices. Still, a very general but simple argument can be drawn along the lines of Theorem\u00a053.In order to prove that  is decidable\nusing Theorem\u00a053, it suffices to show that  are -extensible for a suitable\ncomputable context function. Let  be a finite theorem-set of either  or , that is,  for some , if such a set exists. In that case, if  is the set of bivaluations characterizing  and  then it is clear that . When none of the component logics has a finite theorem-set then , and compactness implies that . Symmetrically, let  be a finite anti-theorem-set of either  or , that is,  for some , if such a set exists. In that case, if  then it is clear that . As before,  if none of the component logics has a finite anti-theorem-set, in which case compactness implies that .We consider , which can clearly be computed.\nSuppose now that  are the sets of bivaluations (closed for substitutions) characterizing the component logics ,\nand that  agree in  for some finite set , that is  for every .If  for every  then none of the component logics has a finite theorem-set, , and hence . On the other hand, if  for every  then none of the component logics has a finite anti-theorem-set, , and hence . Thus, we proceed knowing that we can fix formulas  such that  and .First we modify  so that they also agree on  (for simplicity, we chose to evaluate them all to ). Consider the substitution  such thatand let  and . Easily,  extend  on , and further agree on all formulas in .Inductively, let  and obtain bivaluations  extending the previous on , and further agreeing on . For each formula  with  we evaluate  and modify the skeleton variable  accordingly when building . Hence, consider for each  the substitution  such thatand set . Easily, if , or  and ,\nthen , and thus .\nFurthermore, if  and  then\n.Partitioning each  in two disjoint parts , and , for , it is clear that , , and also that  and  are a partition of . Further, each  shows precisely that . The compactness of both  and  then implies that\n and . Therefore, the bivaluation  such that  if , and  if  (resulting as a limit of the above sequences of bivaluations) is such that . Of course,  agrees with  on , which concludes the argument. We will further illustrate the use of such general results to concrete combined logics in the more familiar case, below, of single-conclusion logics.\nOf course, our general decidability preservation technique using a suitable context function resembles many of the decidability preservation techniques used in concrete examples, such as fusions of modal logics\u00a0[41], or even beyond in combining equational and first-order theories\u00a0[58, 57, 7, 71, 61]. A deeper account of the scope of the abstraction we propose is beyond the reach of this paper.\n5.3.2 Deciding single-conclusion combined logics\nAs before, the single-conclusion case can now be addressed as an application of the same ideas. A single-conclusion logic  is decidable if there exists an algorithm , which terminates when given any finite set  and formula  as input, and outputs  if , and  if . As before, we will henceforth assume with lost of generality that the logic at hand is compact, as this definition is equivalent to deciding the compact version  of the logic.\nThe following very simple result will help us to apply the ideas used in the multiple-conclusion scenario, to the single-conclusion case.\nThe following implications hold.If a multiple-conclusion logic  is decidable, then so is its single-conclusion companion .If a single-conclusion logic  is decidable, then so is its minimal multiple-conclusion counterpart .\nWe consider each property.Let , and  be an algorithm deciding .\nTo decide  consider the following algorithm .Clearly,  if and only if , and  decides .Let , and  be an algorithm deciding .\nTo decide  consider the following algorithm .Clearly,  if and only if  for some . Hence,  decides .\n\u220eNow, to go directly to the results, we say that single-conclusion logics ,  are -extensible when  and  are sets of bivaluations characterizing them, that is,  and , and their (uniquely determined) meet-closures  are -extensible.Again, this definition has a more abstract alternative characterization, based on theories.Let ,  be multiple-conclusion logics,  their combination, and  a context function. The following are equivalent:,  are -extensible;given  and theories  of  for , if\n then there exists a theory  of  such that .The result is immediate, taking into account Proposition\u00a016 and the fact that, for each , the unique meet-closed set of bivaluations characterizing\n is .\u220eAs before, we obtain a general decidability preservation result.Let  be -extensible logics. If  is computable and  are both decidable then their combination  is also decidable.Let  and , both closed for substitutions, be such that  and . From Proposition\u00a056\u00a0(b), we know that  and  are both decidable. From the hypothesis of -extensibility of , we know that  are -extensible, and thus also\n. Then, Theorem\u00a053 guarantees that  is decidable.\nBut we know that , and Proposition\u00a056\u00a0(a) guarantees that it is decidable.Putting together the algorithms obtained in the proofs of Theorem\u00a053 and Proposition\u00a056, if  are algorithms deciding , respectively, we obtain the following\nnon-deterministic algorithm  for deciding .\u220eLet us illustrate some particular applications of Theorem\u00a058.Let  be saturated PNmatrices with a total strict product .\nIf ,  are both decidable then also their combination  is decidable.Given Theorem\u00a058, it is enough to observe that  are -extensible whenever  is total.By saturation, Lemma\u00a020 guarantees that  for each . Their -extensibility follows easily from the fact that also  are -extensible, implied by the hypothesis that the strict product is total, as in the proof of Corollary\u00a054.\n\u220eThe case of disjoint combinations is also worth revisiting.(Decidability preservation for disjoint combinations, again).\nWe are now able to obtain a simple proof of the the major result of\u00a0[51]: the preservation of decidability for disjoint combinations of single-conclusion logics. Namely, let  be decidable and\n. Using Proposition\u00a056 we know that  are decidable as well, and the result in Example\u00a055 tells us that  is also decidable. Finally, note that using again Proposition\u00a056, we have that\n is decidable, and we know that\n.A more direct proof of the same result could instead be obtained from Theorem\u00a058, along an argument similar to the one used in Example\u00a055 for the multiple-conclusion setting. Ultimately, our results followed simply as applications of the corresponding results in the multiple-conclusion case. In any case, a result analogous to Lemma\u00a052 can still be obtained, which would imply Theorem\u00a058 and Corollary\u00a059, as well, and which can be understood as a decidability-friendly version of Corollary\u00a017.Let ,  be -extensible single-conclusion logics, and consider their combination . For every finite , we have:Using Corollary\u00a017, if  then there exists  such that  is a theory of both\n and\n. Easily then, one has  for each ,\nand .Reciprocally, if there is  such that , but with  for each  then\nit follows that \nand  are theories such that .\nThus, directly from -extensibility and Lemma\u00a057, we can conclude that\nthere exists a theory  of  such that\n.\nIt follows that  and we conclude that .\u220e\n6 Conclusion\nThe main contribution of this paper is the definition of a first modular semantics for combined logics, in both the single and multiple-conclusion scenarios.\nIt is worth emphasizing again that the analysis of the latter scenario was crucial for the development, due to its tight connection with bivaluations. Of course, bivaluations could be simply seen as partitions of the language, or as theories, but looking at them as semantic functions helps to smoothen the path to many-valued interpretations. Naturally, the adoption of PNmatrices as models was also fundamental, as partiality enables us to deal with possibly conflicting interpretations of shared language, whereas non-determinism makes it straightforward to accomodate language extensions.\nDiscovering the finiteness-preserving strict-product operation on PNmatrices and its universal property were certainly central to the results obtained.\nFurther, it should be said that it provides a solution to the problem at hand which is quite close to the abstract idea of Gabbay\u2019s fibring function\u00a0[38, 40, 18], and a very natural modular version of Schechter\u2019s proposal\u00a0[63]. Unfortunately, when combining single-conclusion logics, this is simply not enough. The solution we found uses the -power operation for saturation purposes, but at the expense of losing finite-valuedness. This path hinders the easy application of these techniques in practice for single-conclusion logics, in general, also because checking saturation does not seem to be a trivial task. Nevertheless, we have seen that -powers may ultimately be too radical a solution, namely as finite powers are sometimes sufficient. Clearly, a better understanding of saturation is necessary, namely also regarding its connection with admissibility of rules, as studied for instance in\u00a0[47, 27, 11].\nAt this point we should remark that the fact that we only consider logics defined by a single PNmatrix, instead of a collection of PNmatrices, is a simplifying assumption with almost no loss of generality, as we have shown that partiality allows for summing collections of PNmatrices whenever one has at least one connective with more than one place.\nThe three applications developed taking into account our semantic characterizations are also worth mentioning as valuable contributions.\nFirst, the construction of a semantics for strengthening a given many-valued logic with additional axioms is interesting in its implications, but just a reinterpretation of a result in\u00a0[20], where less general but finite semantics for certain well-behaved particular cases are also obtained. Nevertheless, obtaining a denumerable PNmatrix for intuitionistic propositional logic is a worth example of the compressing power of partiality and non-determinism, and deserves to be further explored, namely in connection with ideas for aproximating logics (see, for instance,\u00a0[9, 33, 42, 56, 59]).\nSecondly, studying conditions under which the problem of obtaining a calculus for a logic may be split into the problem of obtaining axiomatizations for suitable syntactically defined fragments of the logic is quite crucial for a modular understanding of combining logics. A related approach was considered in\u00a0[29], but aiming at a disjoint split with additional axioms. On the contrary, the results we obtain here are inline with ideas explored in\u00a0[21] concerning axiomatizations of classical logic, and fit well with our running track of research on extracting calculi for PNmatrices in an automated way, namely using monadicity requirements\u00a0[54, 19].\nThird, and last, having a clear semantics for combined logics is a crucial tool for studying their decidability. The very general criteria we obtained already cover previous results regarding disjoint combinations, as we have shown. We believe they are also powerful enough to encompass other results in the literature, like the decidability of fusions of modal logics\u00a0[74, 41], and even adaptations of Nelson-Oppen-like techniques for deciding certain equational and first-order theories\u00a0[58, 57, 7, 71, 61]. A thourough analysis of the complexity of the obtained decision algorithms was intentionally not addressed in this paper, but certainly deserves future attention.\n"]}
